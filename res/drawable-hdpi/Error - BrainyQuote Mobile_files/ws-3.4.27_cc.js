/*
 WebSpectator 3.4.27 (173258.411)
*/
var JSON;
JSON||(JSON={},function(){function Z(f){return 10>f?"0"+f:f}function B(f){C.lastIndex=0;return C.test(f)?'"'+f.replace(C,function(f){var m=$[f];return"string"===typeof m?m:"\\u"+("0000"+f.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+f+'"'}function l(f,C){var w,P,X,$,la=m,U,y=C[f];y&&("object"===typeof y&&"function"===typeof y.toJSON)&&(y=y.toJSON(f));"function"===typeof V&&(y=V.call(C,f,y));switch(typeof y){case "string":return B(y);case "number":return isFinite(y)?String(y):"null";case "boolean":case "null":return String(y);case "object":if(!y)return"null";
m+=x;U=[];if("[object Array]"===Object.prototype.toString.apply(y)){$=y.length;for(w=0;w<$;w+=1)U[w]=l(w,y)||"null";X=0===U.length?"[]":m?"[\n"+m+U.join(",\n"+m)+"\n"+la+"]":"["+U.join(",")+"]";m=la;return X}if(V&&"object"===typeof V){$=V.length;for(w=0;w<$;w+=1)"string"===typeof V[w]&&(P=V[w],(X=l(P,y))&&U.push(B(P)+(m?": ":":")+X))}else for(P in y)Object.prototype.hasOwnProperty.call(y,P)&&(X=l(P,y))&&U.push(B(P)+(m?": ":":")+X);X=0===U.length?"{}":m?"{\n"+m+U.join(",\n"+m)+"\n"+la+"}":"{"+U.join(",")+
"}";m=la;return X}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+Z(this.getUTCMonth()+1)+"-"+Z(this.getUTCDate())+"T"+Z(this.getUTCHours())+":"+Z(this.getUTCMinutes())+":"+Z(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
C=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,m,x,$={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},V;"function"!==typeof JSON.stringify&&(JSON.stringify=function(f,C,w){var P;x=m="";if("number"===typeof w)for(P=0;P<w;P+=1)x+=" ";else"string"===typeof w&&(x=w);if((V=C)&&"function"!==typeof C&&("object"!==typeof C||"number"!==typeof C.length))throw Error("JSON.stringify");return l("",{"":f})});
"function"!==typeof JSON.parse&&(JSON.parse=function(m,l){function C(f,m){var x,B,y=f[m];if(y&&"object"===typeof y)for(x in y)Object.prototype.hasOwnProperty.call(y,x)&&(B=C(y,x),void 0!==B?y[x]=B:delete y[x]);return l.call(f,m,y)}var x,m=String(m);f.lastIndex=0;f.test(m)&&(m=m.replace(f,function(f){return"\\u"+("0000"+f.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(m.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return x=eval("("+m+")"),"function"===typeof l?C({"":x},""):x;throw new SyntaxError("JSON.parse");})}());
(function(Z){function B(){this._events={};this._maxListeners=10}function l(f,l,m,x,B){this.type=f;this.listener=l;this.scope=m;this.once=x;this.instance=B}l.prototype.fire=function(f){this.listener.apply(this.scope||this,f);if(this.once)return this.instance.removeListener(this.type,this.listener),!1};B.prototype.eachListener=function(f,l){var m=null,x=null,B=null;if(this._events.hasOwnProperty(f)){x=this._events[f];for(m=0;m<x.length;m+=1)if(B=l.call(this,x[m],m),!1===B)m-=1;else if(!0===B)break}return this};
B.prototype.addListener=function(f,C,m,x){this._events.hasOwnProperty(f)||(this._events[f]=[]);this._events[f].push(new l(f,C,m,x,this));this.emit("newListener",f,C,m,x);this._maxListeners&&(!this._events[f].warned&&this._events[f].length>this._maxListeners)&&("undefined"!==typeof console&&console.warn("Possible EventEmitter memory leak detected. "+this._events[f].length+" listeners added. Use emitter.setMaxListeners() to increase limit."),this._events[f].warned=!0);return this};B.prototype.on=B.prototype.addListener;
B.prototype.once=function(f,l,m){return this.addListener(f,l,m,!0)};B.prototype.removeListener=function(f,l){this.eachListener(f,function(m,x){m.listener===l&&this._events[f].splice(x,1)});this._events[f]&&0===this._events[f].length&&delete this._events[f];return this};B.prototype.removeAllListeners=function(f){f&&this._events.hasOwnProperty(f)?delete this._events[f]:f||(this._events={});return this};B.prototype.listeners=function(f){if(this._events.hasOwnProperty(f)){var l=[];this.eachListener(f,
function(f){l.push(f.listener)});return l}return[]};B.prototype.emit=function(f){for(var l=[],m=null,m=1;m<arguments.length;m+=1)l.push(arguments[m]);this.eachListener(f,function(f){return f.fire(l)});return this};B.prototype.setMaxListeners=function(f){this._maxListeners=f;return this};Z.EventEmitter=B})(this);
(function(){var Z,B={version:"3.4.27"},l="undefined"!=typeof B?B:{version:"0.0.0"},f=l.core={},C=[],m,x,$,V,Pa,O=new function(){var a=new EventEmitter;a.setMaxListeners(50);this.listeners=function(b){return a.listeners(b)};this.listen=function(b,c,e){b||w("!invalid event name: '"+b+"'");a.addListener(b,c,e)};this.unlisten=function(b,c){a.removeListener(b,c)};this.emit=function(b){a.emit.apply(a,Array.prototype.slice.call(arguments,0))}},w=function(a,b){f.log(a,"core",b)},P=new function(a){a=window[a];
if(!a)throw Error("script parameters not found!");this.getParam=function(b,c,e,g){b=a[b];null==b?b=e:g&&(b="1"===b?!0:!1);return b};this.toString=function(){var a=[];if("undefined"!==typeof window._wsvars)for(i in window._wsvars)a.push(i+" : '"+window._wsvars[i]+"'");return a.sort().join("\n")}}("_wsvars");f.id=(+new Date+"").slice(-4);f.extendAPI=function(a){X.extend(a)};var X=new function(a,b){var c=a[b]={};this.extend=function(a){for(var b in a)c[b]=a[b]};this.getObject=function(){return c}}(window,
"WS");f.extension=new function(){var a={};this.make=function(b,c,e){var g=a[b];null==g&&(g=[],a[b]=g);g.push(c);return function(){var c=a[b],g=null,j=Array.prototype.slice.apply(arguments),k=j.length;j.push(null);for(var n=0;n<c.length;n++)g=c[n].apply(e?e:this,j),j[k]=g;return g}};this.add=function(b,c){a[b].push(c)}};f.zone=new function(a){var b={},c=function(a,b,c){this.constructor.prototype.init.apply(this,arguments)};c.prototype=new function(a){this.log=function(b){a.log(b,"zone '"+this.id+"'")};
this.init=a.extension.make("core.zone.init",function(b,c,e){this.id=b||c.getAttribute(a.globalParameters.attZoneId)||"";this.bannerId=a.util.trim(c.getAttribute(a.globalParameters.attBannerId)||"");this.element=c;this.options=e;this.log("initCore")});this.start=a.extension.make("core.zone.start",function(){this.log("startCore")});this.del=a.extension.make("core.zone.del",function(){this.log("deleted zone: "+this)});this.getData=a.extension.make("core.zone.getdata",function(){return{id:this.id,bannerId:this.bannerId}});
var b=a.extension.make("core.zone.tostring",function(a){var b={};b.id=a.id;b.bannerId=a.bannerId;return b});this.toString=function(){return JSON.stringify(b(this))}}(a);c.prototype.constructor=c;var e=function(g,e,q){g=a.util.trim(g);null!=b[g]?g=null:(g=new c(g,e,q),b[g.id]=g,g.start(),w("created zone: "+g.toString()));return g};this.getZone=function(a){return b[a]};this.eachZone=function(a,c){var e,j;for(j in b)if(e=a(b[j],j),"undefined"!=typeof e&&!1==e)break;c&&c()};this.deleteZone=function(a,
c){var e,c=c||{};return(e=c.zone)||(e=b[a])?(delete b[a],e.del(),!0):!1};this.createZone=function(a,b,c){return e(a,b,c)};this.clearZones=function(){for(var a in b)this.deleteZone(a,{zone:b[a]})};this.parseZones=function(){var b,c,q=0;w("parsing '"+f.globalParameters.zoneClassName+"' class for ad zone");c=document.getElementsByClassName(f.globalParameters.zoneClassName);for(var j=0,k=c.length;j<k;j++){b=c[j];if(0==b.offsetHeight){var n=b.getAttribute("style")||"";b.setAttribute("style","float:left;"+
n)}if("auto"==b.style.zIndex||"inherit"!=b.style.zIndex&&1>b.style.zIndex)b.style.zIndex=1;(n=b.getAttribute(a.globalParameters.attZoneId))&&e(n,b,{timeStamp:a.startTimeStamp})&&q++}w("parseZones: created "+q+" zone(s)")};this.getPrototype=function(){return c.prototype};this.zones=function(){return b}}(f);f.events=new function(a,b){this.eventType={};this.listen=function(a,b,c){O.listen(a,b,c)};this.unlisten=function(a,b){O.unlisten(a,b)};this.emit=function(a,b){O.emit.apply(O,Array.prototype.slice.call(arguments,
0))};for(var c=this.eventType,e=0,g=b.length;e<g;e++)c[b[e]]=b[e]}(f,"viewportChanged scroll resize focus blur zoneIn zoneOut zoneInTentative bannerIn bannerOut bannerInTentative bannerPrint bannerResize frameLoaded campaignBannerPrint messageSent messageReceived messageChangeBanner instrumentationLoaded ortcConnected ortcDisconnected userIdle userActive click keypress keydown mousemove bannerGts zoneGts".split(" "));f.util=new function(a){this.scriptEvents={focusStatusChanged:"ws_focusStatusChanged",
connectionStatusChanged:"ws_connectionStatusChanged",zoneStatusChanged:"ws_zoneStatusChanged",userStatusChanged:"ws_userStatusChanged",scriptStatusChanged:"ws_scriptStatusChanged"};this.DOM=new function(){var a=/px/,b=function(b){b=b.replace(a,"");return""==b||"auto"==b?0:parseInt(b)};this.getElementCss=function(a){var b=null;a.currentStyle?b=a.currentStyle:window.getComputedStyle&&(b=document.defaultView.getComputedStyle(a,null));return b};this.getElementWidth=function(a){return a.offsetWidth||b(this.getElementCss(a).width)||
b(a.style.width)};this.getElementHeight=function(a){return a.offsetHeight||b(this.getElementCss(a).height)||b(a.style.height)}};this.executeOnPredicate=function(a,b,c,q){var q=q||0,j=this;5<=q?w("executeOnPredicate: max tries reached ("+q+") for function:"+a):b()?a():(q++,setTimeout(function(){j.executeOnPredicate.call(j,a,b,c,q)},c||1E3))};this.PartialTimer=function(){var a=0,b=0;this.start=function(c){a=c||+new Date;b=0};this.stop=function(c){if(0==a)return 0;b=c||+new Date;return b-a};this.on=
function(){return 0<a};this.startTime=function(){return a};this.toJSON=function(){var c={};c.begin=a;c.end=b;c.elapsed=0==b?0:b-a;return c}};this.trim=function(a){return(a||"").replace(/^\s+|\s+$/g,"")};this.isArray=function(a){return a&&"object"===typeof a&&"number"===typeof a.length&&"function"===typeof a.splice&&!a.propertyIsEnumerable("length")};this.ts=function(){var a=new Date;return""+a.getFullYear()+("0"+(a.getMonth()+1)).slice(-2)+("0"+a.getDate()).slice(-2)+" "+("0"+a.getHours()).slice(-2)+
("0"+a.getMinutes()).slice(-2)+("0"+a.getSeconds()).slice(-2)+"."+("00"+a.getMilliseconds()).slice(-3)};var b;"undefined"===typeof console&&(window.console={tlog:"",log:function(){return!0}});this.logger={log:function(c,g){var D="("+a.id+") ["+this.ts()+"] "+(g?"["+g+"] ":"")+c;(!b||D.match(b))&&console.log(D)},filter:function(a){b=a?RegExp(a,"i"):!1}};this.log=this.logger.log;this.raiseEvent=function(a,b,c,q){b=b||{};b.id=f.id;b.index=Pa;c=!!c;q=!!q;if(document.createEvent){var j=document.createEvent("CustomEvent");
j.initCustomEvent(a,c,q,b);document.dispatchEvent(j)}else if(document.name)for(func in document.name)document.name[func](b)};this.bindEvent=function(a,b,c){document.addEventListener?a.addEventListener(b,c):document.createEvent?a.attachEvent(b,c):(a.name||(a.name=[]),a.name.push(c))};this.viewport=new function(){this.scrollTop=function(){var a;a=window.pageYOffset?window.pageYOffset:document.body.scrollTop?document.body.scrollTop:document.documentElement.scrollTop;"undefined"==typeof a&&(a=0);return a};
this.scrollLeft=function(){var a;a=window.pageXOffset?window.pageXOffset:document.body.scrollLeft?document.body.scrollLeft:document.documentElement.scrollLeft;"undefined"==typeof a&&(a=0);return a};this.height=function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight};this.width=function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}};this.cookies=new function(){this.createCookie=function(a,b,c){if(c){var q=
new Date;q.setTime(q.getTime()+864E5*c);c="; expires="+q.toGMTString()}else c="";document.cookie=a+"="+b+c+(V?"; domain=."+V:"")+"; path=/"};this.readCookie=function(a){for(var a=a+"=",b=document.cookie.split(";"),c=0;c<b.length;c++){for(var q=b[c];" "==q.charAt(0);)q=q.substring(1,q.length);if(0==q.indexOf(a))return q.substring(a.length,q.length)}return null};this.eraseCookie=function(a){this.createCookie(a,"",-1)}};var c=[];this.bind=function(a,b,D,q){q=q||{};q.prefix="undefined"!=typeof q.prefix?
q.prefix:!0;document.addEventListener?a.addEventListener(b,D):a.attachEvent((q.prefix?"on":"")+b,D);q.auto&&c.push({t:a,e:b,cb:D})};this.unbindAll=function(){for(var a=c.length,b;a--;)b=c[a],b.t.detachEvent?b.t.detachEvent("on"+b.e,b.cb):b.t.removeEventListener(b.e,b.cb)}}(f);f.register=function(a,b,c){l[a]=b;C.push(b);b.log=function(b,c){f.log(b,c||a)};for(var e in c)O.listen(e,c[e],l[a]);w("registered module: '"+a+"'")};f.getParam=function(a,b,c,e,g){a=P.getParam(a,b,c,e);w(b+":'"+a+"'",g);return a};
f.log=function(a,b,c){(x||c)&&f.util.log(a,b)};f.mouseMoveHandler=new function(){this.lastMoveTimeStamp=this.y=this.x=this.ts=-1;this.update=function(a,b,c){var e=!1;this.ts=a;this.x!==b&&this.y!==c&&(this.lastMoveTimeStamp=this.ts,e=!0);this.x=b;this.y=c;return e}};f.init=function(){m=l.instrumentation;f.util.bind(window,"scroll",function(){var a=0,b;return function(g){clearTimeout(b);w("scroll:"+ ++a);b=setTimeout(function(){O.emit("scroll",g)},200)}}(),{auto:!0});f.util.bind(window,"resize",function(){var a=
0,b;return function(g){clearTimeout(b);w("resize:"+ ++a);b=setTimeout(function(){O.emit("resize",g)},200)}}(),{auto:!0});f.util.bind(window,"blur",function(){var a=0,b;return function(g){clearTimeout(b);w("blur:"+ ++a);b=setTimeout(function(){O.emit("blur",g)},200)}}(),{auto:!0});f.util.bind(window,"focus",function(){var a=0,b;return function(g){clearTimeout(b);w("focus:"+ ++a);b=setTimeout(function(){O.emit("focus",g)},200)}}(),{auto:!0});f.globalParameters.trackIdleOn&&(f.util.bind(window,"keypress",
function(a){O.emit("keypress",a)},{auto:!0}),f.util.bind(window,"keydown",function(a){O.emit("keydown",a)},{auto:!0}),f.util.bind(window,"mousemove",function(a){f.mouseMoveHandler.update(a.timeStamp,a.screenX,a.screenY)&&O.emit("mousemove",a)},{auto:!0}),f.util.bind(document,"mousemove",function(a){f.mouseMoveHandler.update(a.timeStamp,a.screenX,a.screenY)&&O.emit("mousemove",a)},{auto:!0}),f.util.bind(window,"click",function(a){O.emit("click",a)},{auto:!0}));for(var a=0,b=C.length;a<b;a++)C[a].init&&
C[a].init();$&&f.util.logger.filter($);f.startTimeStamp=+new Date;f.zone.parseZones(!0);a=0;for(b=C.length;a<b;a++)C[a].ready&&C[a].ready();f.util.raiseEvent(f.util.scriptEvents.scriptStatusChanged,{action:"ready"});w("init core")};f.isDebug=!1;f.reset=function(){f.util.unbindAll();for(var a=0,b=C.length;a<b;a++)C[a].reset&&C[a].reset()};x=f.getParam("dbg","debugOn",!1,!0);f.globalParameters={};f.globalParameters.attZoneId="data-pid";f.globalParameters.attBannerId="data-bid";f.globalParameters.attBannerWidth=
"data-bannerWidth";f.globalParameters.attBannerHeight="data-bannerHeight";f.globalParameters.attCampaignId="data-cpid";f.globalParameters.attFirstPrint="data-cfp";f.globalParameters.attDisplayTime="data-dt";f.globalParameters.attImpressionId="data-iid";f.globalParameters.attRemnant="data-remnant";f.globalParameters.attTracker="data-tracker";f.globalParameters.attClose="data-close";f.globalParameters.attContentUrl="data-contenturl";f.globalParameters.sessionId=f.getParam("sessionId","sessionId","0");
f.globalParameters.contextId=f.getParam("contextId","contextId","0");f.globalParameters.websiteId=f.getParam("wid","websiteId","");f.globalParameters.publicId=f.getParam("cid","publicId","");f.globalParameters.msgVersion=f.getParam("mve","messageVersion","");f.globalParameters.zoneClassName=f.getParam("zcn","zoneClassName","wsz");var mb=f.getParam("sfo","scriptInFrameOn",2);f.globalParameters.scriptInFrameOn=2==mb?window!=window.top:1==mb;f.globalParameters.trackIdleOn=f.globalParameters.scriptInFrameOn?
!1:f.getParam("tio","trackIdleOn",!0,!0);$=f.getParam("lfe","logFilterExp","");f.InitOnLoad=f.getParam("iol","initOnLoad",!0,!0);f.InitOnPageLoad=f.getParam("ipl","initOnPageLoad",!1,!0);V=f.getParam("tld","topLevelDomain","");"undefined"==typeof document.getElementsByClassName&&(f.util.bind(window.document,"focusin",function(){var a=0,b;return function(c){clearTimeout(b);w("focus:"+ ++a);b=setTimeout(function(){O.emit("focus",c)},200)}}()),f.util.bind(window.document,"focusout",function(){var a=
0,b;return function(c){clearTimeout(b);w("blur:"+ ++a);b=setTimeout(function(){O.emit("blur",c)},200)}}()));Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0,e=this.length;c<e;c++)if(this[c]===a)return c;return-1});document.getElementsByClassName||(document.getElementsByClassName=function(a){for(var b=[],a=RegExp("\\b"+a+"\\b"),c,e=this.getElementsByTagName("*"),g=e.length;g--;)c=e[g],1==c.nodeType&&a.test(c.className)&&b.push(c);return b});Pa=(new function(){var a=window.WS_SCRIPTS||
(window.WS_SCRIPTS=[]);this.add=function(b){a.push(b);return a.length-1};this.get=function(b){return a[b]}}).add(X.getObject());f.extendAPI({id:f.id,version:l.version,index:Pa,init:function(){f.init()}});var la=function(){x=!x;return"log "+(x?"on":"off")},U=function(a){if(a&&"?"===a[0])return"arguments: filter regex [string];";a=a?a[0]:null;f.util.logger.filter(a);return a?"set log filter to '"+a+"'":"clear log filter"},y=function(){alert(P.toString())},nb=function(){var a=0;w("dumping zones:");f.zone.eachZone(function(b){w(b.toString());
a++;return!0});var b=a+" zones found";w(b);return b},uc=function(){f.zone.clearZones();return"all zones deleted"},vc=function(){f.zone.parseZones();nb();return"parsed zones"},wc=function(){alert(l.version)};f.events.listen(f.events.eventType.instrumentationLoaded,function(){m&&(m.addOper("log - toggle enabled",la),m.addOper("script - show params",y),m.addOper("zones - dump",nb),m.addOper("zones - clear",uc),m.addOper("zones - parse",vc),m.addOper("script - show version",wc),m.addOper("log - set filter",
U))});(function(a,b){var c={},e=a.core,g,D,q,j=function(a){eval("var ret = "+a);return ret},k=function(b){var c,g,e,k,D,q=[],d,f,h={};this.addOper=function(a,b){t(a,b)};var l=function(a){if(""==a)return null;var c=RegExp(b.argumentsSeparator+b.argumentsSeparator,"g"),a=a.replace(RegExp(b.argumentsSeparator,"g"),"\ufffd"),a=a.replace(c,b.argumentsSeparator);return a.split("\ufffd")},m=function(a){for(var b=0;b<a.options.length;b++)if(a.options[b].selected)return a.options[b].value;return null},t=function(a,
b){h[a]=b;var c;c=[];for(var g in h)c.push(g);c=c.sort(function(a,b){return a>=b?1:-1});f.innerHTML="";for(var e=0,k=c.length;e<k;e++)g=document.createElement("option"),g.innerHTML=e+1+". "+c[e],g.value=c[e],f.appendChild(g)};this.exec=function(a,b){var c;if("."==a[0])switch(a.substring(1).toLowerCase()){case "h":this.showHistory()}else try{"undefined"!=typeof(c=j(a))&&this.msg(c),b&&q.push(a)}catch(g){this.msg(g,!0)}};this.exec2=function(a,b){var c;try{c=a(b),"undefined"===typeof c&&(c=""),this.msg(c)}catch(g){this.msg(g,
!0)}};this.showHistory=function(){if(0==q.length)this.msg("history empty",!0);else{d=!0;var a;a=q.slice(0>q.length-10?0:q.length-10).reverse();for(var b="<div style='padding:2px 2px 2px 2px;width:100%;text-align:center;font-weight:bold'>Command History:</div>",g=0;g<a.length;g++)b+="<span style='font-weight:solid'><b>"+g+"</b> - "+a[g]+"</span></br>";var e=document.createElement("div");e.setAttribute("style","border:2px solid;-moz-border-radius:5px; border-radius:5px;padding:5px 5px 5px 5px;position:fixed;bottom:0;width:300px;height:180px;color=#ff0000;background-color:#58D3F7;overflow:auto;opacity:1;z-index:9999");
e.innerHTML=b;c.appendChild(e);var j=c,D=this;window.onkeydown=function(b){if(!d)return!1;null==b&&(b=window.event);var c="undefined"!==typeof b.keyCode&&(null!=b.keyCode?b.keyCode:b.which);if(!(48<=c&&57>=c||27==c))return!1;b=!1;27==c?b=!0:(c=parseInt(String.fromCharCode(c)),c<a.length&&(k.value=a[c],b=!0));b&&(j.removeChild(e),D.cancelEvent());return d=!1}}};this.cancelEvent=function(){window.onkeydown=null};this.msg=function(a,b){var c=b?g:e;c.innerHTML="  "+a;setTimeout(function(){c.innerHTML=
""},3E3)};this.show=function(){c.style.display="";D=!0};this.hide=function(){c.style.display="none";D=!1};this.toggle=function(){D?this.hide():this.show()};this.clear=function(){c.innerHTML=""};var r=this,p,u;u=b.barMinimal;c=document.createElement("div");c.innerHTML="<div style='vertical-align:middle;position: fixed;bottom:0;width: 100%;height:25px;background-color:#000000;overflow:none;opacity:1;z-index:2147483647'></div>";p=c.lastChild;u||(u=document.createElement("button"),u.style.fontSize="11px",
u.style.margin=0,u.style.verticalAlign="baseline",u.style.display="inline",u.innerHTML="close",u.onclick=function(){r.hide()},p.appendChild(u),u=document.createElement("button"),u.style.fontSize="11px",u.style.margin=0,u.style.verticalAlign="baseline",u.style.display="inline",u.innerHTML="clear",u.onclick=function(){k.value="";k.focus()},p.appendChild(u),k=document.createElement("input"),k.setAttribute("type","text"),k.style.fontSize="11px",k.style.margin=0,k.style.verticalAlign="baseline",k.style.display=
"inline",k.style.width="250px",k.onkeydown=function(a){if(d)return!1;null==a&&(a=window.event);switch("undefined"!==typeof a.keyCode&&(null!=a.keyCode?a.keyCode:a.which)){case 13:r.exec(k.value,!0);break;case 220:"undefined"!==a.ctrlKey&&a.ctrlKey&&r.showHistory()}return!0},p.appendChild(k),u=document.createElement("input"),u.type="button",u.style.fontSize="11px",u.style.margin=0,u.style.verticalAlign="baseline",u.style.display="inline",u.value=">",u.onclick=function(){r.exec(k.value,!0)},p.appendChild(u));
f=document.createElement("select");f.style.fontSize="11px";f.style.margin=0;f.style.verticalAlign="baseline";f.style.display="inline";u=b.operations.slice(0);u.sort(function(a,b){var c,g,e;for(e in a)c=e.toLowerCase();for(e in b)g=e.toLowerCase();return c>g?1:-1});for(var s=0;s<u.length;s++)t(u[i]);p.appendChild(f);u=document.createElement("input");u.type="button";u.style.fontSize="11px";u.style.margin=0;u.style.verticalAlign="baseline";u.style.display="inline";u.value=">";u.onclick=function(){r.exec2(h[m(f)],
l(k?k.value:""))};p.appendChild(u);e=document.createElement("span");e.setAttribute("style","color:#ffffff;font-size:10px");p.appendChild(e);g=document.createElement("span");g.setAttribute("style","color:#ff0000;font-size:10px");p.appendChild(g);u=document.createElement("span");u.setAttribute("id","version");u.setAttribute("style","float:right;margin-right:5px;color:#ff0000;font-size:12px;align:right;valign:middle");u.innerHTML=a.version;p.appendChild(u);u=document.createElement("span");u.setAttribute("style",
"float:right;margin-right:5px;color:#FFFFFF;font-size:12px;align:right;valign:middle");u.innerHTML="Status:<span id='scriptStatus'></span>";p.appendChild(u);c.appendChild(p);document.body&&document.body.appendChild(c);this.hide()};c.init=function(){D&&e.util.executeOnPredicate(function(){var a=e.getParam("itp","instrumentationTriggerPosition",4),b=e.getParam("ito","instrumentationVisibleOn",!1,!0),a=parseInt(a,10);if(1>a||4<a)a=4;g=new k({operations:[],argumentsSeparator:";",barMinimal:q});b&&g.show();
b=document.createElement("div");b.setAttribute("id","ws_inst_trigger");b.onclick=function(a){a=a||window.event;null!=a&&a.shiftKey&&g.toggle()};if(null!=navigator.userAgent.match("iPad")){var c="";e.events.listen(e.events.eventType.keypress,function(a){c+=a.keyCode-48;null!="57932".match(c)?(window.clearTimeout(void 0),"57932"==c?g.toggle():window.setTimeout(function(){c=""},1E3)):c=""})}b.setAttribute("style",["top:0","top:0;right:0","bottom:0;right:0","bottom:0"][a-1]+";padding:5px;position:fixed;width:5px;height:5px;background-color:#ff0000;opacity:0.0;filter: alpha(opacity = 0);z-index:2147483647");
document.body&&document.body.appendChild(b);e.events.emit("instrumentationLoaded")},function(){return document.body});c.log("init instrumentation")};D=e.getParam("sio","scriptInstrumentationOn",!0,!0);q=e.getParam("ibm","instrumentationBarMinimal",!1,!0);c.addOper=function(a,b){g&&g.addOper(a,b)};c.setStatus=function(a){var b=document.getElementById("scriptStatus");switch(a){case 1:b.innerHTML="Active";b.style.color="green";break;case 0:b.innerHTML="Inactive";b.style.color="red";break;case 2:b.innerHTML=
"Idle",b.style.color="orange"}};e.register(b,c,{})})(l,"instrumentation");var ta={},da=l.core,Ba=l.instrumentation,Qa,Ra,Ca={},xc=function(a){return!a||!(1<=a.length&&2>=a.length)?"arguments: el id [string]; zone id [string]*":ob({domElement:document.getElementById(a[0]),id:a[1]||a[0]})},yc=function(a){return!a||1!=a.length?"arguments: el id [string];":pb({id:a[0]})},zc=function(a){return!a||!(1<=a.length&&2>=a.length)?"arguments: el id [string]; categories list [string]*":qb({id:a[0],categories:a[1]||
""})};da.events.listen(da.events.eventType.instrumentationLoaded,function(){Ba&&(Ba.addOper("zone - create",xc),Ba.addOper("zone - delete",yc),Ba.addOper("zone - categories hint",zc))});var ob=function(a){var b=a.domElement,a=a.id;if(null==b)return ta.log("createAdZone: DOM element is null"),!1;var c=a+"";if(null==a||""==a||""==(c=da.util.trim(c)))return ta.log("createAdZone: ID is null or empty"),!1;b=da.zone.createZone(c,b);Qa&&Qa.sendViewportState();return b},pb=function(a){a=a.id;return null==
a?!1:da.zone.deleteZone(a)},qb=function(a){var b=a.id,a=a.categories,c;if(null==b)return!1;c=da.zone.getZone(b);return null!=c?(c.setCategories(b,a.split(",")),!0):!1};Ca.setLocationHint=function(a){var b=a.currentLocationHref,a=a.currentLocationHint;null!=b&&(Ra.currentLocationHref=b);null!=a&&(Ra.currentLocationHint=a);return!0};Ca.Zones={create:function(a){return ob(a)},del:function(a){return pb(a)},setHint:function(a){return qb(a)}};Ca.Events={bind:function(a,b,c){da.util.bindEvent(a,b,c)}};ta.init=
function(){Ra=l.analyticszones;Qa=l.tracking;ta.log("init api")};da.register("api",ta,{});da.extendAPI(Ca);var Y={},r=l.core,Da=l.instrumentation,rb,sb,ma,tb,ub,vb,ua,wb,xb,yb,Sa,E=function(a){Y.log(a)},Q,zb=function(a,b,c){E("Ortc: message received on channel '"+b+"':'"+c+"'");L&&L("messageReceived",JSON.parse(c))},Bb=function(a,b,c){b=b||Ab;if(!na&&Sa)return E("Ortc: not connected. buffering message to resend: "+a),va.push(a),L&&L("messageSent",{message:a,channel:b,sent:0}),!1;G&&(G.send(b,a.toString()),
L&&(c=c||{},L("messageSent",{message:a,channel:b,sent:c.sent||1})));return!0},Cb=function(){if(0==va.length)E("Ortc: no buffered messages to resend");else{E("Ortc: resending buffered messages");for(var a,b=0;na&&0<(a=va.splice(0,1)).length;)Bb(a[0],ga.outputChannel,{sent:2}),b++;E("Ortc: resent "+b+" message(s)")}},Ac=function(){na=!0;E("Ortc: connected");for(var a=Ta.length,b=0;b<a;b++)Db(Ta[b],zb);G.setConnectionMetadata(Ua(++Va));Sa&&Cb();"function"===typeof L&&L("connected",+new Date)},Db=function(a,
b){G.subscribe(a,!0,b);E("Ortc: subscribing to channel:'"+a+"'")},Bc=function(){na=!1;E("Ortc: disconnected");"function"===typeof L&&L("disconnected",+new Date)},Cc=function(a,b){E("Ortc: subscribed to channel:'"+b+"'")},Dc=function(a){E("Ortc: unsubscribed from channel:'"+a.channel+"'")},Ec=function(a,b){E("Ortc: exception:'"+b+"'")},Eb=function(){E("Ortc: reconnected");G.setConnectionMetadata(Ua(++Va));na=!0;Cb();L&&L("reconnected",+new Date)},Fb=function(){na=!1;E("Ortc: reconnecting");L&&L("reconnecting",
+new Date)},na,G,ga,L,va=[],Ta,Ab,Va=0,Wa,Xa,Ua=function(a){if("function"!=typeof L)return null;a=L("getConnMetadata",{connectionId:a}).toString();E("Ortc: connection metadata: "+a);return a};Q={init:function(a){ga=a;var b=ga.isCluster,c=ga.serverUrl;Wa=ga.authToken;Xa=ga.appKey;Ta=ga.inputChannel;Ab=ga.outputChannel;var e=Ua(Va);loadOrtcFactory(IbtRealTimeSJType,function(a,D){if(null!=D)return E("Ortc: error connecting to ORTC"),!1;null!=a&&(G=a.createClient(),null!=e&&G.setConnectionMetadata(e),
G.setId("client"),G.setConnectionTimeout(1E3),E("Ortc: connection timeout: 1000"),b?G.setClusterUrl(c):G.setUrl(c),G.onConnected=Ac,G.onSubscribed=Cc,G.onUnsubscribed=Dc,G.onException=Ec,G.onDisconnected=Bc,G.onReconnecting=Fb,G.onReconnected=Eb,G.connect(Xa,Wa))});return!0},setup:function(a){L=a.listener},send:Bb,subscribe:function(a){if(a)for(var a="[object Array]"!==Object.prototype.toString.call(a)?[a]:a,b=0;b<a.length;b++)Db(a[b],zb)},reconnecting:Fb,reconnected:Eb,dumpBuffer:function(){for(var a=
0,b=va.length;a<b;a++)E(va[a]);E(b+" message(s) buffered")},connect:function(){G.connect(Xa,Wa)},disconnect:function(){G.disconnect()},isConnected:function(){return G&&G.getIsConnected()},existsOrtcClient:function(){return null!=G}};var Gb=new function(a){var b=[],c=function(b){a.log("channelSubscriptionHelper: "+b)},e=function(a){c("enqueuing "+JSON.stringify(a));b.push(a)};this.subscribe=function(a){Q.isConnected()?Q.subscribe(a):e({type:"s",ch:a})};this.unsubscribe=function(a){Q.isConnected()?
Q.subscribe(a):e({type:"u",ch:a})};r.events.listen(r.events.eventType.ortcConnected,function(){var a,e,q;if(0==(e=a=b.length))c("queue empty");else{for(;a--;)q=b.shift(),"s"==q.type?Q.subscribe(q.ch):"u"==q.type&&Q.unsubscribe(q.ch);c("Finished processing queue with size "+e)}})}(Y),Fc=function(){Q.disconnect();return"ORTC disconnect..."},Gc=function(){Q.connect();return"ORTC connect..."},Hc=function(){return"ORTC "+(Q.isConnected()?"":"not")+" connected"};r.events.listen(r.events.eventType.instrumentationLoaded,
function(){Da&&(Da.addOper("ortc - disconnect",Fc),Da.addOper("ortc - connect",Gc),Da.addOper("ortc - isConnected",Hc))});sb=r.getParam("crt","connectOrtcOn",!0,!0);ma=r.getParam("uos","urlOrtcServer","").split(",");ma=ma[Math.floor(Math.random()*ma.length)];tb=r.getParam("oic","ortcIsCluster",!0,!0);ua=r.getParam("cip","channelInPrefix","");wb=r.getParam("cop","channelOutPrefix","");xb=r.getParam("aut","authToken","");Sa=r.getParam("rmo","resendMessagesOn",!0,!0);yb=r.getParam("apk","appKey","");
var Hb=r.globalParameters.publisherChannelId=r.getParam("cid","publisherChannelId","");ub=ua+Hb;vb=wb+Hb;Y.sendMessage=function(a,b){Q.send(a,b)};Y.subscribeChannel=function(a){for(var a=r.util.isArray(a)?a:[a],b=a.length;b--;)Gb.subscribe(ua+a[b])};Y.unsubscribeChannel=function(a){for(var a=r.util.isArray(a)?a:[a],b=a.length;b--;)Gb.unsubscribe(ua+a[b])};Y.init=function(){rb=l.messaging;setTimeout(Q.disconnect,18E5);var a={connected:function(a){E("Ortc listener: ortc connected");r.events.emit(r.events.eventType.ortcConnected,
a)},reconnected:function(a){E("Ortc listener: reconnected");r.events.emit(r.events.eventType.ortcConnected,a)},reconnecting:function(a){E("Ortc listener: reconnecting");r.events.emit(r.events.eventType.ortcDisconnected,a)},disconnected:function(a){E("Ortc listener: disconnected");r.events.emit(r.events.eventType.ortcDisconnected,a)},messageReceived:function(a){E("Ortc listener: messageReceived");E("message received: "+JSON.stringify(a));r.events.emit(r.events.eventType.messageReceived,a)},messageSent:function(a){Y.log("message sent: "+
a.message);r.events.emit(r.events.eventType.messageSent,a)},getConnMetadata:r.extension.make("ortc.metadata",function(a){var c=rb.Message.create();c.addAction("cd");c.add(r.globalParameters.publicId);c.add(a.connectionId);c.addDebug(l.version||"0.0.0");return c})};Z=function(b,c){return a[b](c)};Q.setup({listener:Z});sb&&(E("connecting to ORTC on url:'"+ma+"'"),r.util.executeOnPredicate(function(){r.util.raiseEvent(r.util.scriptEvents.connectionStatusChanged,{action:"connecting"});var a=[];a.push(ub);
a.push(ua+r.globalParameters.sessionId+":"+r.globalParameters.contextId);Q.init({websiteId:r.globalParameters.websiteId,contextId:r.globalParameters.contextId,sessionId:r.globalParameters.sessionId,serverUrl:ma,isCluster:tb,inputChannel:a,outputChannel:vb,authToken:xb,appKey:yb})},function(){return!!window.loadOrtcFactory}));Y.log("init ortc")};r.register("ortc",Y,{ortcConnected:function(a){Y.log("onOrtcConnected: "+a);r.util.raiseEvent(r.util.scriptEvents.connectionStatusChanged,{action:"connected"})},
ortcDisconnected:function(a){Y.log("onOrtcDisconnected: "+a);r.util.raiseEvent(r.util.scriptEvents.connectionStatusChanged,{action:"disconnected"})}});var M={},I=l.core,ea,Ea=l.instrumentation,Ic=I.globalParameters.msgVersion,Fa,Ya,Ga,wa,Za,W,ja=new function(){var a=function(a){var c,e,g=[],D=[];this.add=function(a,b){b&&(a=encodeURIComponent(a));g.push(a)};this.addAction=function(a){g[1]=a};this.field=function(a){var b="";switch(a){case "action":b=g[1];break;default:b=null}return b};this.addId=function(a){g[FIELD_ID]=
a};this.addDebug=function(a,b){D.push(b?encodeURIComponent(a):a)};this.toString=function(){var a=g;1<D.length&&(a=a.concat(D));return a.join(c)};this.fieldSeparator="|";c=a.sep;e=a.debugPrefix;g[0]=a.version;g[1]=a.action;g[2]=a.websiteId;g[3]=a.sessionId;g[4]=a.contextId;D.push(e)};this.create=function(b){var b=b||{},c={sep:"|",debugPrefix:"!!DBG:",id:"",action:""};c.version=Ic;c.websiteId=b.websiteId||I.globalParameters.websiteId;c.sessionId=I.globalParameters.sessionId;c.contextId=I.globalParameters.contextId;
return new a(c)}},oa=function(a){return"undefined"==typeof a||null==a?!1:!0};M.sendMessage=function(a){if(ea)for(var a=I.util.isArray(a)?a:[a],b=0,c=a.length;b<c;b++)ea.sendMessage(a[b])};M.sendViewportState=function(a){if(ea&&oa(a.ts)&&oa(a.flag)){var b=ja.create();b.addAction("su");b.add(a.ts);b.add(a.zoneIds);b.add(a.bannerIds);b.add(a.campaignIds);b.add(a.flag);b.add("undefined"!=typeof wa?wa:"");b.add(Ya);b.add(Ga);M.sendMessage(b)}};M.sendPostInitState=function(a){if(ea&&oa(a.ts)){var b=ja.create();
b.addAction("pi");b.add(""+ +new Date);b.add(a.data);M.sendMessage(b)}};M.sendImpressionNotification=function(a){if(ea&&oa(a.bannerId)&&oa(a.zoneId)){var b=ja.create();b.addAction("bit");b.add(a.bannerId);b.add(a.zoneId);b.add(a.campaignId||"");M.sendMessage(b)}};M.sendGtsNotification=function(a){if(ea){var b=ja.create();b.addAction(a.action);b.add(a.zoneId);b.add(a.bannerId);b.add(a.campaignId||"");M.sendMessage(b)}};M.sendTrackingZones=function(a){if(ea&&oa(a.trackingzoneIds)){var b=ja.create();
b.addAction("wstz");b.add(a.trackingzoneIds);b.add(a.timestamp);b.add(a.screenWidth);b.add(a.currentLocationHint);b.add(a.focus);M.sendMessage(b)}};M.sendChangeBannerRequest=function(a){if(ea){var b=ja.create(a);b.addAction("cbreq");b.add(a.pid);b.add("undefined"!=typeof a.bannerId?a.bannerId:"");b.add("undefined"!=typeof a.script?a.script:"");b.add("undefined"!=typeof a.mode?a.mode:"");b.add("undefined"!=typeof a.meta?a.meta:"");b.add("undefined"!=typeof a.state?a.state:"");b.add(Ya);b.add(Ga);b.add("undefined"!=
typeof wa?wa:"");b.add("undefined"!=typeof Za?Za:"");a.cpid&&b.add(a.cpid);a.testdata&&b.add(JSON.stringify(a.testdata));M.sendMessage(b)}};M.Message=ja;M.init=function(){I=l.core;ea=l.ortc;Fa=I.getParam("plo","pageLoggerOn",!1,!0);Ya=I.getParam("ip","userIp","0.0.0.0",!1);wa=I.getParam("country_code","country","",!1);Za=I.getParam("region","region","",!1);var a=navigator.userAgent;if(-1==a.indexOf("MSIE"))Ga=a;else{var b=a.match(/(Mozilla\/\d*\.\d*\s?\()(compatible;)?(\s?[\w\s\d\.\/]*;){0,2}(\s?[\w\s\d\.\/]*)/gmi);
Ga=null==b||-1==a.indexOf("MSIE")?a:b[0]+")"}Fa&&I.util.executeOnPredicate(function(){Ib(!0)},function(){return document.body});M.log("init messaging")};var Jc=function(a){var b,c,e,g=1,D="",d=[];this.setFilter=function(a){D=a;for(var c in b.childNodes){var g=b.childNodes.item(c);g.style.display=g.innerHTML.match(a)?"":"none"}};this.setOpacity=function(a){b.style.opacity=a};this.setBgColor=function(a){b.style.backgroundColor=a};this.setHeight=function(a){b.style.height=a+"px"};this.setFontSize=function(a){e=
a};this.show=function(){b.style.display="";c=!0};this.hide=function(){b.style.display="none";c=!1};this.toggle=function(){c?this.hide():this.show();return c};this.clear=function(){b.innerHTML=""};this.addLineDecorator=function(a,b){d.push([RegExp(a,"g"),b])};this.write=function(a){if(c){var k=document.createElement("div");k.setAttribute("style","text-align:left;z-index:2147483640;font-weight:bold;color:#ff0000;opacity:1.0;font-size:"+e+"px");for(var n='<span style="color:#0000ff">'+("000"+g++).slice(-3)+
"</span> ",f=d.length,h=0;h<f;h++)a=a.replace(d[h][0],d[h][1]);k.innerHTML=n+a;k.innerHTML.match(D)||(k.style.display="none");0===b.childNodes.length?b.appendChild(k):b.insertBefore(k,b.childNodes.item(0));setTimeout(function(){k.style.color="#000000"},2E3)}};a=a||{};e=a.fontSize||11;a=a.height||100;b=document.createElement("div");b.setAttribute("style","line-height: 13px;padding:5px;position: fixed;bottom:0;width: 99%;border: 0px solid black;height:"+a+"px;background-color:yellow;overflow:auto;opacity:0.8;z-index:2147483640");
b.setAttribute("id","page-logger");document.body&&document.body.appendChild(b);this.hide()},Kc=function(a){W&&W.write((0==a.sent?"!":2==a.sent?"*":"")+"["+I.util.ts()+"] "+a.message)},Lc=function(a){W&&W.write("["+I.util.ts()+"] "+a.a+"|"+(a.d.zone||a.d.z)+"|"+(a.d.state||"")+"|"+(a.d.content&&""!=a.d.content?"newbanner":"empty"))},Ib=function(a){I.events.listen(I.events.eventType.messageSent,Kc);I.events.listen(I.events.eventType.messageReceived,Lc);W=new Jc({height:150});a&&W.show()},Mc=function(){!W&&
Ib();W.toggle()},Nc=function(){Fa&&W&&W.clear()},Oc=function(a){Fa&&W&&W.setFilter(a&&0<a.length?a[0]:"")};I.events.listen(I.events.eventType.instrumentationLoaded,function(){Ea&&(Ea.addOper("page log - filter",Oc),Ea.addOper("page log - toggle enabled",Mc),Ea.addOper("page log - clear",Nc))});I.register("messaging",M,{});var v={},h=l.core,$a,R=l.instrumentation,ka,pa=!1,Jb,ab,Kb,Ha,Lb,bb,N=!0,Mb,Nb,Ob,cb,Ia=!1,Ja,J,Pc=function(){ka=!ka;return"focus "+(ka?"on":"off")},Qb=function(a){pa=!pa;h.zone.eachZone(function(b){pa?
Pb({zone:b,inspection:{top:b.top,left:b.left,width:b.width,height:b.height,verticalVisible:0,horizontalVisible:0,visibleArea:0,name:a?a[b.id]?a[b.id]:"INVALID":null}}):null!=b.overlay&&(b.overlay.del(),delete b.overlay);return!0});return"zones overlay "+(pa?"on":"off")};v.toggleOverlay=Qb;var Qc=function(a){return!a||1!=a.length?"arguments: threshold secs [int]":"visibility threshold: "+parseInt(a[0],10)+" ms"},Rc=function(a){if(!a||1!=a.length)return"arguments: threshold % [int]";ab=a=parseInt(a[0],
10);return"visibility threshold: "+a+" ms"},Sc=function(a){var b=a.id,c,e=document.createElement("UL"),g;this.addContent=function(){var a=document.createElement("DIV");a.id="overlay_"+b;a.setAttribute("style","font-size:14px;text-align:center;opacity:1;z-index:2147483647;background-color:lime;width:100%;min-height:25px;");var d=document.createElement("BUTTON");d.innerHTML="Request Banner";d.setAttribute("style","float:right");d.onclick=function(){h.zone.getZone(b).nextBanner({bannerId:"-1"})};c=document.createElement("B");
c.innerHTML="pid:"+b;c.setAttribute("style","float:left");a.appendChild(c);a.appendChild(d);g.appendChild(a);g.appendChild(e)};this.hide=function(){g.setAttribute("style","display:none")};this.del=function(){g&&g.parentNode.removeChild(g)};this.setVolatileColor=function(a){g.style.backgroundColor=a};this.show=function(a){a.data.name&&(c.innerHTML=a.data.name+"(pid:"+b+")");"INVALID"==a.data.name&&(c.style.color="red");g.setAttribute("id","overlay_shell_"+b);g.setAttribute("style","display:'';border:3px solid lime; position:absolute;top:0px;left:0px;height:"+
a.data.height+"px;width:"+a.data.width+"px;z-index:10000000;overflow:visible")};this.addEntry=function(a){var b=document.createElement("LI");b.style.margin="0px 0px";b.innerHTML=a.getHours()+":"+a.getMinutes()+":"+a.getSeconds();e.appendChild(b)};this.init=function(){var a=document.createElement("DIV");a.setAttribute("class","wsOverlay");a.setAttribute("style","position:relative;height:0px;width:0px");var c=h.zone.getZone(b),e=c.element;e.insertBefore(a,e.firstChild);g=document.createElement("div");
a.appendChild(g);c.overlayData=this;this.addContent();if(c.queue){a=c.queue.getData();for(c=0;c<a.length;c++)this.addEntry(new Date(parseInt(a[c].visibId.substring(0,a[c].visibId.length-3))))}};e.style.position="absolute";e.style.padding="0px";e.style.backgroundColor="lime";e.style.bottom="0px";this.init(a)},Pb=function(a){var b=a.zone;pa&&(null==b.overlay&&(b.overlay=new Sc({id:b.id,data:a.inspection,opacity:0.5})),b.overlay.show({data:a.inspection,text:"<b>pid:"+b.id+"</b>"}))},Tc=function(a){Pb(a)};
h.events.listen(h.events.eventType.instrumentationLoaded,function(){R&&(R.addOper("zones - toggle overlay",Qb),R.addOper("focus - toggle enabled",Pc),R.addOper("zones - change visibility threshold",Qc),R.addOper("zones - change banner's area threshold",Rc),h.events.listen(h.events.eventType.zoneInTentative,Tc))});var Sb=function(a){var a=a||{},b=a.timeStamp||a.event?a.event.timeStamp||+new Date:+new Date,c={height:Kb,minAreaVisible:ab,top:a.top,left:a.left,id:this.id};this.wsOwner&&(c.width=this.width,
c.height=this.height,c.useDimensions=!0);c=Rb(this.element,c);a.reset&&(c.inViewport=!1);"undefined"!=typeof a.forceInViewport&&(c.inViewport=a.forceInViewport);this.left=c.left;this.top=c.top;this.width=c.width;this.height=c.height;var e=this.currView;this.currView=c.inViewport&&N;a={inspectData:c,timeStamp:b,reset:a.reset};this.currView&&!e?this.intoView(a):!this.currView&&e&&this.outOfView(a);this.log((this.currView?"ON":"OFF")+" VIEW | (zone) t:"+this.top+" l:"+this.left+" w:"+this.width+" h:"+
this.height+(c.defaultHeight?"*":"")+" a:"+c.visibleArea+"% | (viewport): t:"+c.viewportTop+" r:"+c.viewportRight+" b:"+c.viewportBottom+" l:"+c.viewportLeft+" w:"+c.viewportWidth+" h:"+c.viewportHeight)},Rb=function(a,b){var c,e,g,d,q,j,k,n,f,l,sa=0,m=0,p=0,r,t=b.minAreaVisible||100;j=h.util.viewport.scrollLeft();q=h.util.viewport.scrollTop();k=h.util.viewport.height();n=h.util.viewport.width();g=h.util.DOM.getElementCss(a);r="undefined"!==typeof a.style&&("none"==g.display||"hidden"==g.visibility);
if("undefined"!==typeof b.top&&"undefined"!==typeof b.left)c=b.top,e=b.left;else if(c=a.offsetTop,e=a.offsetLeft,g.position&&"fixed"==g.position)c+=q,e+=j;else{for(g=a;"HTML"!=g.nodeName&&g.offsetParent;){g=g.offsetParent;d=h.util.DOM.getElementCss(g);if(d.position&&"fixed"==d.position){c+=q+g.offsetTop;e+=j+g.offsetLeft;break}c+=g.offsetTop;e+=g.offsetLeft}for(g=a;"HTML"!=g.nodeName&&g.parentNode&&!(g=g.parentNode,d=h.util.DOM.getElementCss(g),r=r?r:d&&("none"==d.display||"hidden"==d.visibility),
d&&"fixed"==d.position););}d=h.util.DOM.getElementHeight(a);g=h.util.DOM.getElementWidth(a);b.useDimensions&&b.height&&(d=parseInt(b.height));b.useDimensions&&b.width&&(g=parseInt(b.width));f=j+n;l=q+k;c>=q&&c+d<=l&&e>=j&&e+g<=f?p=100:c+d<q||c>l||e+g<j||e>f?p=0:(c>=q&&c+d<=l?sa=d:c<q?sa=c+d-q:c<l&&(sa=l-c),e>=j&&e+g<=f?m=g:e<j?m=e+g-j:e<f&&(m=f-e),p=Math.round(100*(sa*m/(d*g))));return{top:c,left:e,width:g,height:d,defaultHeight:void 0,viewportTop:q,viewportRight:f,viewportBottom:l,viewportLeft:j,
viewportWidth:n,viewportHeight:k,verticalVisible:sa,horizontalVisible:m,visibleArea:p,inViewport:r?!1:p>=t?!0:!1}},Uc=new function(){var a=!1,b=!0,c=window.attachEvent?!0:!1,e,g,d;this.isIdle=function(){return a};this.setIdle=function(a){j(a)};this.clear=function(){v.log("clear idle: "+d);clearTimeout(d)};var f=function(b,c){Ia=a=b;R&&R.setStatus(Ia?2:1);h.events.emit(b?h.events.eventType.userIdle:h.events.eventType.userActive);b?(Ja&&h.util.cookies.createCookie("ws-idl","1",1),e?S({reset:!0}):c&&
c.pingViewport&&Ka()):(Ja&&h.util.cookies.eraseCookie("ws-idl","",-1),e?S():Ka())},j=function(b){b=b||{};v.log("set idle with options: "+JSON.stringify(b));!a&&N&&(clearTimeout(d),f(!0,b))};this.signalActiveEvent=function(e){e=e||{};b&&"onmousemove"==e.eventName?b=!1:c&&"onfocus"==e.eventName?c=!1:(clearTimeout(d),d=setTimeout(function(){j({pingViewport:!0})},g),a&&f(!1,e))};this.init=function(){g=h.getParam("tip","trackIdlePeriod",19);e=h.getParam("rvi","resetViewportOnIdle",!0,!0);g*=1E3;Ja&&h.util.cookies.readCookie("ws-idl")?
j({pingViewport:!0}):d=setTimeout(function(){j({pingViewport:!0})},g)}}(v),Tb=new function(){var a=new function(){var a,c,e,g;this.zones=function(){return a};this.banners=function(){return c};this.campaigns=function(){return e};this.equals=function(a,b,c,e){return g==d(a,b,c,e)};this.update=function(f,j,k,n){a=j;c=k;e=n;g=d(f);v.log("update viewstate to: "+g)};var d=function(g,d,k,n){return"z:"+(d||a.join())+"|b:"+(k||c.join())+"|c:"+(n||e.join())+"|f:"+g}};this.reset=function(){clearTimeout(bb);
Ha=0};this.sendStatus=function(b){if(Jb){var b=b||{},c,e=[],g=[],d=[],f=!!b.ignoreViewport,j=Ia?2:N?1:0;if(Mb||!f){var k=h.zone.zones(),n;for(n in k)c=k[n],Sb.call(c,b),e.push(c.currView&&(c.fp||0<c.height)?c.id||"":""),g.push(c.currView&&(c.fp||0<c.height)?!cb&&c.remnant?"":c.bannerId||"":""),d.push(!cb&&c.remnant?"":c.campaignId||"")}if(f||!a.equals(j,e,g,d))clearTimeout(bb),f||(a.update(j,e,g,d),v.log("viewportStateHelper: viewport changed: zones ("+e.length+"): "+e.join()+" banners ("+g.length+
"): "+g.join())),$a&&$a.sendViewportState({ts:b.ts?b.ts:+new Date,zoneIds:2==j||0==j?"":a.zones(),bannerIds:2==j||0==j?"":a.banners(),campaignIds:a.campaigns(),flag:j}),Ha&&(bb=setTimeout(Ka,Ha))}}},S=Tb.sendStatus,Ka=function(){S({ignoreViewport:!0})},Vc=function(){v.log("user idle");h.util.raiseEvent(h.util.scriptEvents.userStatusChanged,{action:"idle"})},Wc=function(){v.log("user active");h.util.raiseEvent(h.util.scriptEvents.userStatusChanged,{action:"active"})},Xc=function(){J&&J.signalActiveEvent({eventName:"onmousemove",
pingViewport:N})},Yc=function(){J&&J.signalActiveEvent({eventName:"onkeypress",pingViewport:N})},Zc=function(){J&&J.signalActiveEvent({eventName:"onkeydown",pingViewport:N})},$c=function(){J&&J.signalActiveEvent({eventName:"onclick",pingViewport:N})},ad=function(a){N&&(J&&J.signalActiveEvent({eventName:"onscroll",pingViewport:N}),S({event:a}))},bd=function(a){N&&(J&&J.signalActiveEvent({eventName:"onresize",pingViewport:N}),S({event:a}))},cd=function(a){if(ka||!a)v.log((ka?"":"!")+"focus"),N=!0,R&&
R.setStatus(1),S({event:a}),a&&J&&J.signalActiveEvent({eventName:"onfocus",pingViewport:!1}),h.util.raiseEvent(h.util.scriptEvents.focusStatusChanged,{action:"focusin"})},dd=function(a){ka&&(v.log("blur"),N=!1,R&&R.setStatus(0),J&&J.signalActiveEvent({eventName:"onblur",pingViewport:!1}),S({event:a,reset:!0}),J&&J.clear(),h.util.raiseEvent(h.util.scriptEvents.focusStatusChanged,{action:"focusout"}))},ba=function(a){return RegExp(a+"=(?:'|\")([^('|\")]*)(?:'|\")")},db=function(a,b,c){var e=null,a=
a.match(b);null!=a&&c<a.length&&(e=a[c]);return e},Ub,ed=ba(h.globalParameters.attFirstPrint);Ub=function(a){var b=a.element.outerHTML,c=/data-fp=['|"]1['|"]/;b&&null!=b.match(c)?(v.parseZoneData(a,b),a.fp=!0):"1"==db(b,ed,1)&&(v.parseZoneData(a,b),a.cfp=!0,h.events.emit(h.events.eventType.bannerPrint,a))};var fd=function(){N="hidden"!=document.webkitVisibilityState;S()},Vb={bannerId:ba(h.globalParameters.attBannerId),campaignId:ba(h.globalParameters.attCampaignId),displayTime:ba(h.globalParameters.attDisplayTime),
impressionId:ba(h.globalParameters.attImpressionId),remnant:ba(h.globalParameters.attRemnant),contentUrl:ba(h.globalParameters.attContentUrl),gtsTrackerUrl:ba(h.globalParameters.attTracker),close:ba(h.globalParameters.attClose)},Wb={remnant:function(a){return"1"!=a?!1:!0}};v.parseZoneData=function(a,b,c){var c=c||{},e,g={},d={},f=c.map,c=c.tokens;for(e in Vb)g[e]=Vb[e];for(e in c)g[e]=c[e];for(e in Wb)d[e]=Wb[e];for(e in f)d[e]=f[e];for(var j in g)if(e=db(b,g[j],1))a[j]=d[j]?d[j](e):e,v.log("parseZoneData: updated "+
j+":"+a[j])};v.ready=function(){if(h.globalParameters.scriptInFrameOn){document.webkitVisibilityState&&document.addEventListener("webkitvisibilitychange",fd);var a,b=h.getParam("tps","trackingPixelStyle","{}"),b=JSON.parse(b),c={width:"1px",height:"1px",position:"fixed",top:"0px",left:"0px","z-index":"99999",display:"block",padding:"0px",margin:"0px"};for(a in b)c[a]=b[a];var e="";for(a in c)e+=a+":"+c[a]+";";a=function(a){var b='<object id="wsTrackingPixel'+a+'" height="2" width="2" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" align="middle" style="'+
e+'">\n            <param name="movie" value="http://s3.amazonaws.com/webspectator-images/ws-throttle.swf" />\n            <param name="flashVars" value="idZone='+a+'" />\n            <param name="quality" value="high" />\n            <param name="hasPriority" value="true" />\n            <param name="play" value="true" />\n            <param name="loop" value="true" />\n            <param name="wmode" value="window" />\n            <param name="scale" value="showall" />\n            <param name="menu" value="true" />\n            <param name="devicefont" value="false" />\n            <param name="salign" value="" />\n            <param name="allowScriptAccess" value="always" />\n            <\!--[if !IE]>--\>\n            <object id="wsTrackingPixel'+
a+'" data="http://s3.amazonaws.com/webspectator-images/ws-throttle.swf" style="width:  1px; height: 1px; position: fixed; top:  0px; left: 0px; z-index: 99999;" type="application/x-shockwave-flash">\n                <param name="movie" value="http://s3.amazonaws.com/webspectator-images/ws-throttle.swf" />\n                <param name="flashVars" value="idZone='+a+'" />\n                <param name="quality" value="high" />\n                <param name="hasPriority" value="true" />\n                <param name="play" value="true" />\n                <param name="wmode" value="window" />\n                <param name="loop" value="true" />\n                <param name="scale" value="showall" />\n                <param name="menu" value="true" />\n                <param name="devicefont" value="false" />\n                <param name="salign" value="" />\n                <param name="allowScriptAccess" value="always" />\n                <\!--<![endif]--\>\n                <\!--[if !IE]>--\>\n            </object>\n            <\!--<![endif]--\>\n        </object>';
if(!document.getElementById("wsTrackingPixel"+a)){var c=document.createElement("DIV");c.innerHTML=b;document.body.appendChild(c.firstChild);v.log("created flash to track zone: "+a)}};var g,b=h.zone.zones(),d;for(d in b){a((g=b[d]).id);break}var f=g,j;window.__wsZoneInView=function(a,b){v.log("[__wsZoneInView] zone:"+a+" "+("true"==b?"in":"off")+" view");if(a!=f.id)v.log("[__wsZoneInView] zoneid: "+a+" does not match with tracking zone: "+f.toString());else if(b!=j){j=b;var b="true"==b,c={timeStamp:+new Date};
N=f.currView=b;R&&R.setStatus(N?1:0);b?f.intoView(c):f.outOfView(c);S();v.log("[__wsZoneInView] zone changed to "+(b?"in":"off")+" view: "+f.toString())}}}v.log("ready tracking")};v.isFocused=function(){return N};v.isUserIdle=function(){return Ia};v.init=function(){h=l.core;$a=l.messaging;h.globalParameters.trackIdleOn&&(J=Uc,J.init());var a=!h.globalParameters.scriptInFrameOn&&document.hasFocus?document.hasFocus():document.visibilityState?"hidden"!=document.visibilityState:!0;Lb&&!a?h.events.emit(h.events.eventType.blur):
h.events.emit(h.events.eventType.focus);if(Ob&&(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver))(new (window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)(function(){window.setTimeout(function(){S({})},500)})).observe(document,{attributes:!0,childList:!0,subtree:!0});v.log("init tracking")};v.reset=function(){Tb.reset()};Kb=h.getParam("dbh","defaultBannerHeight",155);ka=h.getParam("fcs","focusOn",!0,!0);ab=h.getParam("bat","bannerAreaThreshold",
50);h.getParam("bvt","bannerVisibilityThresholdMs",500);Ha=parseInt(h.getParam("psi","pingStateIntervalMs",1E4));Jb=h.getParam("sso","sendStatusOn",!0,!0);h.getParam("tfo","trackFirstPrintOn",!1,!0);Lb=h.getParam("ifo","initFocusOn",!0,!0);Mb=h.getParam("fcv","forceCheckViewport",!1,!0);Ob=h.getParam("tdc","trackDomChanges",!1,!0);Nb=h.getParam("tze","trackZonesElement",!1,!0);cb=h.getParam("trc","trackRemnantCampaigns",!0,!0);Ja=h.getParam("uic","useIdleCookie",!0,!0);h.events.listen(h.events.eventType.zoneIn,
function(a){v.log("zone in view: "+a);pa&&a.overlay&&a.overlay.setVolatileColor("#00ff00")});h.events.listen(h.events.eventType.zoneOut,function(a){a=a.zone;v.log("zone out view: "+a.toString());h.util.raiseEvent(h.util.scriptEvents.zoneStatusChanged,{action:"inactive",zone:a})});h.events.listen(h.events.eventType.zoneInTentative,function(a){h.util.raiseEvent(h.util.scriptEvents.zoneStatusChanged,{action:"active",zone:a.zone})});h.globalParameters.scriptInFrameOn||(h.events.listen(h.events.eventType.scroll,
ad),h.events.listen(h.events.eventType.resize,bd),h.events.listen(h.events.eventType.focus,cd),h.events.listen(h.events.eventType.blur,dd),h.globalParameters.trackIdleOn&&(h.events.listen(h.events.eventType.mousemove,Xc),h.events.listen(h.events.eventType.keypress,Yc),h.events.listen(h.events.eventType.keydown,Zc),h.events.listen(h.events.eventType.click,$c),h.events.listen(h.events.eventType.userIdle,Vc),h.events.listen(h.events.eventType.userActive,Wc)));var K=h.zone.getPrototype();K.visibleThresholdHnd=
null;K.currView=!1;K.enteredView=!1;K.left=-1;K.top=-1;K.width=0;K.height=0;K.visibleTime=0;K.displayTime=0;K.overlay=null;K.zoneInViewMessage=null;K.zoneTimer=null;K.campaignId=0;K.impressionId=0;K.remnant=!1;K.zoneVisibleTime=0;K.setVisibleTime=function(a){return this.visibleTime+=a};K.setZoneVisibleTime=function(a){return this.zoneVisibleTime+=a};K.intoView=h.extension.make("tracking.intoview",function(a){this.zoneTimer.start(a.timeStamp);this.enteredView=!0;h.events.emit(h.events.eventType.zoneInTentative,
{zone:this,inspection:a.inspectData})});K.outOfView=h.extension.make("tracking.outofview",function(a){var b=this.zoneTimer.stop(a.timeStamp);this.setZoneVisibleTime(b);var c=this.enteredView;this.enteredView=!1;h.events.emit(h.events.eventType.zoneOut,{zone:this,inspection:a.inspectData,inTentativeView:c,visibleTime:b,timeStamp:a.timeStamp})});h.extension.add("core.zone.init",function(){var a=this;this.visibleTime=0;this.zoneTimer=new h.util.PartialTimer;this.viewportChanged=function(b){Sb.call(a,
b)};this.log("initTracking")});h.extension.add("core.zone.start",function(){var a={};h.util.raiseEvent(h.util.scriptEvents.zoneStatusChanged,{action:"inactive",zone:this});Ub(this);var b=this.element.outerHTML,c=/data-ws-dnr=['|"]1['|"]/;this.locked=!this.fp&&b&&null!=b.match(c)?!0:!1;a.InitializeInView&&(this.log("force viewport in"),a.forceInViewport=!0);!h.globalParameters.scriptInFrameOn&&S(a);this.log("startTracking")});h.extension.add("core.zone.getdata",function(a){a.metrics={top:this.top,
left:this.left,width:this.width,height:this.height};return a});h.extension.add("core.zone.del",function(){var a=+new Date;if(this.currView){var b=this.zoneTimer.stop(a);h.events.emit(h.events.eventType.zoneOut,{zone:this,inTentativeView:this.enteredView,visibleTime:b,timeStamp:a});S()}clearInterval(this.visibleThresholdHnd);h.events.unlisten(h.events.eventType.viewportChanged,this.viewportChanged);this.overlay&&this.overlay.del();this.log("delTracking")});h.extension.add("core.zone.tostring",function(a,
b){b.currView=a.currView;b.enteredView=a.enteredView;b.left=a.left;b.top=a.top;b.width=a.width;b.height=a.height;b.visibleTime=a.visibleTime;b.zoneVisibleTime=a.zoneVisibleTime;b.displayTime=a.displayTime;b.campaignId=a.campaignId;b.impressionId=a.impressionId;b.remnant=a.remnant;b.zoneTimer=JSON.stringify(a.zoneTimer.toJSON());return b});h.extension.make("tracking.upgradeFromTentativeView",function(a){v.log("upgradeFromTentativeView: "+a);a.enteredView&&(a.enteredView=!1,h.events.emit(h.events.eventType.zoneIn,
a))});h.extension.make("tracking.inTentativeView",function(a){return a.enteredView});v.sendViewportState=S;v.sendLastViewportState=Ka;v.buildRegex=ba;v.matchRegex=db;v.inspectElement=Rb;l.core.register("tracking",v,{});Nb&&l.core.util.executeOnPredicate(function(){var a="div."+l.core.globalParameters.zoneClassName;v.log("mutation observer on with selector: '"+a+"'");new MutationSummary({callback:function(a){var c=a[0];if(c.attributeChanged){a=c.attributeChanged;v.log("mutation: attributes changed: ");
for(var e in a)v.log("mutation: attr '"+e+"' in elements:"),a[e].forEach(function(a){v.log("data-pid: "+a.getAttribute("data-pid")+"| old value:'"+c.getOldAttribute(a,e)+"'| new value:'"+a.getAttribute(e)+"'")})}},queries:[{element:a,elementAttributes:"style"}]})},function(){return"undefined"!=typeof window.MutationSummary});var s={},d=l.core,fa,ca=l.instrumentation,p,Xb,Yb,eb,Zb,$b,ac,bc,La,cc,xa=!0,dc,gd=function(a){if(!a||!(1<=a.length&&6>=a.length))return"arguments: zone ID [string]; display time secs [int=5]*; banner ID [string list]*; change mode [string=p|n|l]*; use changebanner message [int:0|1]";
var b=a[0],c=a[1]||5,e=a[2],g=a[3]||"r",f=a[5]&&("1"===a[5]?!0:!1);a[4]&&"1"===a[4]?Ma({a:"cb",v:"1.6",d:{z:b,b:e,u:c,c:"666",m:g,content:f?'document.write(\'<div style="width:0px;height:0px" data-iid="f84159fc75413f40" data-bid="299" data-pid="454" data-cpid="49" data-dt="20000" data-fp="1" data-bannerWidth="300" data-bannerHeight="250" ></div>\');document.write(\'<s\' + \'cript type=\\"text/javas\' + \'cript\\" >var urlPing=\\"http://services.webspectator.com/logPrint/49/299/\\" + +new Date;document.write(\\"<s\' + \'cript type=\\\\\\"text/javas\' + \'cript\\\\\\" src=\\\\\\"\\" + urlPing + \\"\\\\\\"><\\\\/s\' + \'cript>\\");<\\/s\' + \'cript><s\' + \'cript src=\\"http://bs.serving-sys.com/BurstingPipe/adServer.bs?cn=rsb&c=28&pli=5759213&PluID=0&w=300&h=250&ord=%%880518651%%&ucm=true&ifl=$$http://adserver.ig.com.br/RealMedia/ads/Creatives/OasDefault/hosting_hospedagem_300605/addineyeV2.html$$&ncu=$$http://services.webspectator.com/pc/30/299/454/e35571bc14cd6bf1?t=880518651&ckurl=http://adserver.ig.com.br/RealMedia/ads/click_lx.ads/%%PAGE%%/%%RAND%%/%%POS%%/%%CAMP%%/%%IMAGE%%/%%USER%%$$&z=99999\\"><\\/s\' + \'cript><nos\' + \'cript><a href=\\"http://services.webspectator.com/pc/30/299/454/e35571bc14cd6bf1?t=880518651&ckurl=http://adserver.ig.com.br/RealMedia/ads/click_lx.ads/%%PAGE%%/%%RAND%%/%%POS%%/%%CAMP%%/%%IMAGE%%/%%USER%%http%3A//bs.serving-sys.com/BurstingPipe/adServer.bs%3Fcn%3Dbrd%26FlightID%3D5759213%26Page%3D%26PluID%3D0%26Pos%3D7334\\" target=\\"_blank\\"><img src=\\"http://bs.serving-sys.com/BurstingPipe/adServer.bs?cn=bsr&FlightID=5759213&Page=&PluID=0&Pos=7334\\" border=0 width=300 height=250><\\/a><\\/nos\' + \'cript>\');':
null}}):(a=d.zone.getZone(b),a.changeBanner({zoneId:a.id,displayTime:1E3*c,bannerId:e,mode:g,forceEntryOptions:!0}))},hd=function(a){if(!a||1>a.length)return"arguments: zone ID [string]";d.zone.getZone(a[0]).nextBanner()},jd=function(a){if(!a||1>a.length)return"arguments: zone id [string]";var a=a[0],b=d.zone.getZone(a);if(null==b)throw"zone "+a+" not found!";b.autoUpdateOn=!b.autoUpdateOn;b.autoUpdateOn&&ec.start();a="zone "+a+" autoupdate "+(b.autoUpdateOn?"on":"off");s.log(a);return a},kd=function(a){if(!a||
1>a.length)return"arguments: zone id [string]";var a=a[0],b=d.zone.getZone(a);if(null==b)throw"zone "+a+" not found!";b.autoUpdateQueueOn=!b.autoUpdateQueueOn;a="zone "+a+" autoUpdateQueue "+(b.autoUpdateQueueOn?"on":"off");s.log(a);return a},ld=function(){d.zone.eachZone(function(a){a.autoUpdateOn=!a.autoUpdateOn;return!0});s.log("toggle autoupdate in all zones");return"toggle autoupdate in all zones"},md=function(a){if(!a||!(1<=a.length&&3>=a.length))return"arguments: zone ID [string]; display time secs [int=5]; banner ID [string list]";
var b=a[0],c=a[2],a=a[1]||5,e=d.zone.getZone(b);e.addBanner({displayTime:1E3*a,bannerId:c,zoneId:b,fetchBanner:!0});e.queue.dump();return"added banner to zone "+b+" queue"},nd=function(a){if(!a||1>a.length)return"arguments: zone ID [string];";a=a[0];d.zone.getZone(a).queue.dump();return"zone "+a+" queue dumped to log"},od=function(a){if(!a||1>a.length)return"arguments: zone ID [string];";var a=a[0],b=d.zone.getZone(a);b.queue.clear();b.queue.dump();return"zone "+a+" queue cleared"},pd=function(a){if(!a||
1>a.length)return"arguments: zoneID; width; height";var b={};b.zone=a[0];b.width=a[1]||300;b.height=a[2]||250;a=new fc.overlayBanner(b,0);d.zone.createZone(a.zone,a.contentDiv,{InitializeInView:!1});b=d.zone.getZone(a.zone);b.nextBanner();b.isOverlay=a};d.events.listen(d.events.eventType.instrumentationLoaded,function(){ca&&(ca.addOper("zone - change banner",gd),ca.addOper("zone - next banner",hd),ca.addOper("zone - toggle autoUpdate",jd),ca.addOper("zone - toggle autoUpdateQueue",kd),ca.addOper("zones - toggle autoupdate",
ld),ca.addOper("zone - add banner",md),ca.addOper("zone - dump queue",nd),ca.addOper("zone - clear queue",od),ca.addOper("zones - add slider",pd))});var T=document.createElement("img"),gc=10,qd=(new Date).getTime();T.setAttribute("height","1px");T.setAttribute("width","1px");T.src="http://images.webspectator.com/px.png?time="+qd;T.alt="";T.style.position="absolute";T.style.top="0px";T.style.left="0px";document.body.appendChild(T);-1==navigator.appName.indexOf("Microsoft Internet Explorer")&&navigator.appName.indexOf("Chrome");
gc=1E3;setTimeout(function(){-1!=navigator.appName.indexOf("Microsoft Internet Explorer")?(T.onabort=function(){xa=!1},T.onerror=function(){xa=!1}):-1==navigator.appName.indexOf("Opera")&&"undefined"!=typeof T.naturalWidth&&0==T.naturalWidth&&(xa=!1);T.complete||(xa=!1)},gc);var hc=function(a,b){b.fetchingBanner=!0;b.requestBeginTs=+new Date;var c=b.requestEndTs=0;(function g(d){c++;b.retriesHnd=setTimeout(function(){var d;fa.sendChangeBannerRequest({websiteId:b.websiteId||null,pid:a.id,state:b.index+
","+c,script:"undefined"!=typeof b.script?b.script:dc,bannerId:b.bannerId,cpid:b.campaignId&&0!=b.campaignId?b.campaignId:null});c<eb?(d=a.queue.get(b.index),d.fetchingBanner?(s.log("cbreq - send requesting (retry:"+c+")"),g(Zb)):s.log("cbreq - stop retries for entry: "+d.toString())):s.log("cbreq - reached max retries: "+eb)},d)})(0)},ya=new function(){var a=[];this.register=function(b,c){a[a.length]={cb:b,scope:c};return this};this.reset=function(){a=[]};this.signal=function(){for(var b=a.length;b--;)"function"==
typeof a[b].cb&&a[b].cb.apply(a[b].scope||null,Array.prototype.slice.call(arguments))}},ic,rd=/"/g,sd=/\n|\r/g,td=/<script/gi,ud=/<\/script/gi;ic=function(a){var b=document.createElement("script"),c="ws_cb_"+a.zone+"_"+ +new Date,e=a.contentUrl+(-1!=a.contentUrl.indexOf("?")?"&":"?")+"callback="+c;s.log("fetching banner data with src: '"+e+"'");b.setAttribute("src",e);document.body.appendChild(b);window[c]=function(g){a.content=a.content.replace('data-tracker=""','data-tracker="'+g.impressionUrl+
'"');g.flash&&(a.content+=g.flash);g=g.banner.replace(rd,'\\"').replace(sd,"").replace(td,'<scr" + "ipt').replace(ud,'</scr" + "ipt').replace("<\!--// <![CDATA[","").replace("// ]]\> --\>","");a.content+='document.write("'+g+'")';a.ignoreContentUrl=!0;Ma({a:"cbresp",d:a},!0);document.body.removeChild(b);delete window[c]}};var Ma=function(a,b){s.log("changeBanner with message: "+JSON.stringify(a));var c,e,g,f,q,j,k=a.d;if(b)if(e={created:+new Date},e.zoneId=k.zone,c=d.zone.getZone(e.zoneId))if(j=d.util.trim(k.content||
""),!j&&c.isOverlay)2>c.isOverlay.retries&&(c.isOverlay.retries++,La?c.isOverlay.close():c.nextBanner());else{p.parseZoneData(e,j);null!=j.match(/data-ws-dnr=['|"]1['|"]/)&&(this.locked=!0);g=j.match(/data-type=['|"]([a-zA-Z]*)['|"]/);if(null!=g&&(e.bannerType=g[1],!xa&&("image"==g[1]||"flash"==g[1]&&!swfobject.hasFlashPlayerVersion("8"))))delete e.bannerId,delete e.campaignId;e.entryId=k.state.split(",")[0];e.html=j;e.close?!La&&c.isOverlay?c.isOverlay.close():(s.log("hide banner content in zone: "+
c.id),0<c.element.childNodes.length&&(c.element.childNodes[parseInt(c.queue.getPrevious().node,10)].style.display="none",c.wsOwner=!1,p&&p.sendViewportState())):(j&&c.isOverlay&&(c.isOverlay.retries=0),!k.ignoreContentUrl&&e.contentUrl?(k.contentUrl=e.contentUrl,ic(k)):c.bannerFetched(e))}else s.log("zone not found in change banner: "+e.zoneId);else{e=k.z;g=k.b;f=k.c;q=k.i;j=k.content;var n=k.u;if(c=d.zone.getZone(e)){if(!j&&(bc&&(fb.setGtsTracker(c,c.queue.getCurrent()),fb.setGtsTrackerInternal(c,
c.queue.getCurrent())),c.isOverlay)){2>c.isOverlay.retries&&(c.isOverlay.retries++,La?c.isOverlay.close():c.nextBanner());return}!c.currView&&!c.isOverlay?s.log("change banner in off view zone not allowed: "+e):(j&&(c.isOverlay&&(c.isOverlay.retries=0),j=j.replace("[WS-SESSIONID]",d.globalParameters.sessionId),"undefined"==typeof q&&(q=p.matchRegex(j,p.buildRegex("data-iid"),1))),-1<cc.indexOf(c.id)?(d.zone.deleteZone(c.id),p&&p.sendViewportState()):c.changeBanner({displayTime:1E3*n,bannerId:g,campaignId:f,
impressionId:q,html:j,data:k,mode:k.m}))}else s.log("zone not found in change banner: "+e)}},gb=[],jc=function(a){switch(a.a){case "cb":Ma(a);break;case "cbresp":Ma(a,!0);break;default:s.log("!!unknown action in message: "+JSON.stringify(a))}};d.events.listen(d.events.eventType.userActive,function(){var a=gb.slice(0),b;gb=[];for(var c=0,e=a.length;c<e;c++)b=a[c],s.log("processing message from queue: "+JSON.stringify(b)),jc(b);s.log("flushed "+e+" messages from queue")});var ec=new function(a){var b,
c=function(b){a.log("bannersUpdateManager: "+b)};this.run=function(a){var b;b=+new Date;if((a.autoUpdateOn||a.autoUpdateQueueOn&&!a.queue.isQueueEmpty()||0<a.updateCount)&&!a.throttlingBannerUpdate&&a.currView&&!a.processingBanner&&!a.isFetchingCurrentBanner())b=a.calculateVisibleTime(b),b>=a.displayTime&&(c("next banner for zone: "+a+" | curr display time: "+b),a.nextBanner())};this.start=function(){!b&&(b=!0)&&ya.register(this.run)};var e=function(a,b){a[b]=!0;c("set "+b+" in zone: "+a.id)};this.init=
function(){var a,b;b=d.getParam("luz","listAutoUpdateZones","");if(""!=(b=d.util.trim(b)))if("*"==b)d.zone.eachZone(function(a){e(a,"autoUpdateOn")});else{b=b.split(",");for(var c=0,j=b.length;c<j;c++)(a=d.zone.getZone(b[c]))&&e(a,"autoUpdateOn")}b=d.getParam("lqz","listAutoUpdateQueueZones","");if(""!=(b=d.util.trim(b)))if("*"==b)d.zone.eachZone(function(a){e(a,"autoUpdateQueueOn")});else{b=b.split(",");c=0;for(j=b.length;c<j;c++)(a=d.zone.getZone(b[c]))&&e(a,"autoUpdateQueueOn")}d.getParam("tbu",
"trackBannersUpdateOn",!1,!0)&&this.start()}}(s),fb=new function(a){var b,c=function(a,b){var c;!b.gtsTrackerSent&&b.gtsTrackerUrl&&(b.gtsTrackerUrl=b.gtsTrackerUrl.replace("[RANDOM]",Math.floor(99999999*Math.random())+999),c="gtstracker-"+a.id+"-"+b.bannerId+"-"+(b.entryId||0),g(c,b.gtsTrackerUrl),b.gtsTrackerSent=!0)},e=function(a,c){if(b&&!c.gtsTrackerInternalSent){var e,k;"["==b[0]?k=JSON.parse(b):(k=[])&&k.push(b);for(var f=0,h=k.length;f<h;f++)e="gtstrackeri-"+a.id+"-"+c.bannerId+"-"+c.entryId,
g(e,d.util.trim(k[f]));c.gtsTrackerInternalSent=!0}},g=function(b,c){a.log("gtsUrlTrackerHelper: "+("### add GTS tracker with class: "+b+" to DOM with url: "+c));var e=document.createElement("IMG");e.setAttribute("class",b);e.setAttribute("style","width:0;height:0;display:none;");e.setAttribute("src",c);document.body.appendChild(e)};this.setGtsTracker=c;this.setGtsTrackerInternal=e;this.init=function(){var a=d.getParam("gto","gtsTrackerOn",!1,!0),g=d.getParam("gti","gtsTrackerInternalOn",!1,!0);b=
d.getParam("lgt","listGtsTrackerUrls","");((b=d.util.trim(b))||a)&&d.events.listen("bannerGts",function(b,d){a&&c(b,d);g&&e(b,d)})}}(s),vd=new function(a){var b={},c,e=function(b){a.log("updateOnGtsHelper: "+b)},g=function(a){var c;if(c=b[a.id])h(a,c),e("triggered update banner in zone: "+a.id+" with delay: "+c),delete b[a.id]},f=function(){var a,c;for(id in b)a=b[id],c=d.zone.getZone(id),c.currView&&(h(d.zone.getZone(id),a),e("triggered update banner in zone: "+id+" with delay: "+a),delete b[id])},
h=function(a,b){setTimeout(function(){a.nextBanner()},b)};this.init=function(){var a,k=d.getParam("lug","listUpdateOnGtsZones",""),k=d.util.trim(k);if(""!=k){var n=[];if(0==k.indexOf("["))n=JSON.parse(k);else if(0==k.indexOf("{"))n=[JSON.parse(k)];else if("*"==k)d.zone.eachZone(function(b){!b.fp&&(!b.cfp&&!b.isOverlay&&!b.sideBanner)&&n.push({z:b,d:a})});else{var aa=k.split(",");if(1==aa.length&&""==d.util.trim(aa[0]))return;for(var n=[],k=0,l=aa.length;k<l;k++)n.push({z:aa[k],d:a})}k=n.length;a=
d.getParam("ugs","updateGTSMs",2E4);for(c=d.getParam("ugv","updateGTSOnView",!0,!0);k--;){if("object"!=typeof(l=n[k].z))l=d.zone.getZone(l);l&&(aa=n[k].d||a,e("update banner in zone: "+l.id+" with delay: "+aa),!c||l.currView&&p.isFocused()&&!p.isUserIdle()?h(l,aa):b[l.id]=aa)}d.events.listen(d.events.eventType.bannerInTentative,g);d.events.listen(d.events.eventType.focus,f);d.events.listen(d.events.eventType.userActive,f)}}}(s),wd=new function(a){var b={},c,e,g,f=function(b){a.log("gtsTrackerHelper: "+
b)},h=function(a){var g=+new Date;if(a.trackGtsEnabled&&a.currView){var n=b[a.id]||0,g=a.calculateVisibleTime(g),h=parseInt(g/c);h>n?(b[a.id]=h,f("gts #"+h+" in zone: "+a),e&&(n={bannerId:a.bannerId,zoneId:a.id,campaignId:a.campaignId,action:"gts"},fa&&fa.sendGtsNotification(n)),d.events.emit(d.events.eventType.bannerGts,a,a.queue.getCurrent())):h<n&&(f("reset gts with visible time "+g),b[a.id]=0)}};this.init=function(){g=d.getParam("lgz","listGtsZones","");if(""!=(g=d.util.trim(g))){c=d.getParam("gts",
"gtsDurationMs",2E4);e=d.getParam("gno","gtsNotificationOn",!1,!0);d.getParam("sgo","sendStatusOnGtsOn",!0,!0);var a=[];"*"==g?d.zone.eachZone(function(b){a.push(b)}):a=g.split(",");for(var b=a.length,f;b--;)f=a[b],"string"==typeof f&&(f=d.zone.getZone(f)),f&&(f.trackGtsEnabled=!0);ya.register(h)}}}(s),xd=new function(a){var b={},c={},e,g,f=function(b){a.log("gtsReportHelper: "+b)},h=function(a){if(a.reportGtsEnabled&&a.currView){var d=+new Date,h=b[a.id]||0,q=a.calculateZoneVisibleTime(d);parseInt(q/
e)>h++&&(b[a.id]=h,f("report gts #"+h+" in zone: "+a),j("gtsr",a));g&&(h=c[a.id]||0,d=parseInt(a.calculatePartialZoneVisibleTime(d)/e),d>h?(c[a.id]=d,f("report contiguous gts #"+d+" in zone: "+a),j("gtscr",a)):d<h&&(c[a.id]=0))}},j=function(a,b){var c={bannerId:b.bannerId,zoneId:b.id,campaignId:b.campaignId,action:a};fa&&fa.sendGtsNotification(c)};this.init=function(){var a=d.getParam("lrg","listReportGtsZones","");if(""!=(a=d.util.trim(a))){e=d.getParam("rgd","reportGtsDurationMs",2E4);g=d.getParam("rcg",
"reportContinuousGtsOn",!1,!0);var b=[];"*"==a?d.zone.eachZone(function(a){b.push(a)}):b=a.split(",");for(var c=0,j=b.length;c<j;c++)if(a="string"==typeof b[c]?d.zone.getZone(d.util.trim(b[c])):b[c])a.reportGtsEnabled=!0,f("reporting gts on zone: "+a.id);ya.register(h)}}}(s),yd=new function(a){var b,c,e,g={},f={},h,j=function(b){a.log("impressionsLogger: "+b)},k=function(a,b){var c={action:b,zoneId:a.id,bannerId:a.bannerId,campaignId:a.campaignId};h&&h.sendGtsNotification(c)},n=function(a){j("banner in tentative view in zone: "+
a);var c,e=a.id,d;if((c=f[e])&&c.impressionId==a.impressionId)d=+new Date,g[e]={hnd:setTimeout(function(){j("iab 1st print for zone: "+a+" at: "+ +new Date);k(a,"iabp");delete g[e]},b),targetTime:d+b,createTime:d},j("iab print for 1st print zone: "+a+" with saved zone data: "+JSON.stringify(c)),delete f[a.id]},aa=function(a,b){j("banner out: "+a+"\nwith options: "+JSON.stringify(b));var c=g[a.id];if(c){var e=a.id;clearTimeout(c.hnd);j("cleared timer for zone: "+e+" with data: "+JSON.stringify(c));
delete g[e]}},l=function(a,c){j("banner print: "+a+"\nwith options: "+JSON.stringify(c));if(a.currView){var e=a.id,d=+new Date,f=b-(d-c.timeStamp),h=d+f;g[e]={hnd:setTimeout(function(){j("iab print for zone: "+a+" at: "+ +new Date);k(a,"iabp");delete g[e]},f),targetTime:h,createTime:d};j("updated timers: "+JSON.stringify(g))}else j("zone off view")};this.init=function(){if(d.getParam("lpo","logPrintsOn",!1,!0)){e=d.getParam("l2p","log2ndPrints",!1,!0);c=d.getParam("lph","logPrintsHiddenZones",!0,
!0);b=d.getParam("lpd","logPrintsDuration",1E3);h=fa;var a,g=d.zone.zones(),m;for(m in g)a=g[m],j("print for zone: "+a),k(a,"tp"),a.currView?(j("iab print for zone: "+a+" at: "+ +new Date),k(a,"iabp")):c&&(f[a.id]={snapshot:a.toString(),impressionId:a.impressionId});e&&(d.events.listen(d.events.eventType.bannerPrint,l),d.events.listen(d.events.eventType.bannerOut,aa));c&&d.events.listen(d.events.eventType.bannerInTentative,n)}}}(s),fc=new function(){var a,b=!!d.util.cookies.readCookie("ws-obp"),c;
this.overlayBanner=function(a,c){this.zone=a.zone;this.width=a.width;this.height=a.height;this.replacer=a.replacer&&JSON.parse(a.replacer);this.posX=a.posX||{pos:"right",dist:0};this.posY=a.posY||{pos:"bottom",dist:0};this.timeout=a.timeout||0;this.alwaysInside="undefined"!=typeof a.alwaysInside?a.alwaysInside:!0;this.contentDiv=this.closeDiv="";this.shadowDiv=a.overlayPage||!1;this.displayTimeout=0;this.animeInterval=null;this.animation=a.animation||"vertical";this.animeIter=a.animeIter||100;this.animeDur=
a.animeDur||2;this.iterations=0;this.zIndex=a.zIndex||2147483646;this.border="undefined"!=typeof a.border?a.border:!0;this.started=!1;this.animString=a.animString;this.transEvent=a.transEvent;this.reOpen=a.reOpen||"true";this.retries=0;this.isVisible=!1;this.repDist=a.repDist;var f=!1;this.updateClose=function(){this.closeDiv.style.left=parseInt(this.contentDiv.style.width.substr(0,this.contentDiv.style.width.length-2))-10+"px"};this.updateLeft=function(){this.decorator.style.left=this.posX.dist-
d.util.viewport.scrollLeft()+"px"};this.updateSize=function(){for(var a=d.zone.getZone(this.replacer).element,b=a.offsetLeft;a.offsetParent;)a=a.offsetParent,b+=a.offsetLeft;this.posX.dist=b;this.decorator.style.left=this.posX.dist-d.util.viewport.scrollLeft()+"px"};this.setCss=function(){this.contentDiv.style.width=this.width+"px";this.contentDiv.style.height=this.height+"px";var a=this.decorator;a.style.display="none";a.style.zIndex=this.zIndex;if("center"!=this.posX.pos)if(c){var e=this.posX.dist+
(d.util.viewport.width()-c.substring(0,c.length-2));a.style[this.posX.pos]=0<e?e/2+"px":e+"px"}else a.style[this.posX.pos]=this.posX.dist+"px";else a.style.setProperty?(a.style.setProperty("margin","0 auto","important"),a.style.setProperty("left","0px","important"),a.style.setProperty("right","0px","important")):(a.style.setAttribute("margin","0 auto","important"),a.style.setAttribute("left","0px","important"),a.style.setAttribute("right","0px","important"));a.style[this.posY.pos]=this.posY.dist+
"px";a.style.position=this.alwaysInside?"fixed":"absolute";this.border?(this.decorator.style.width=this.width+20+"px",this.decorator.style.height=this.height+30+"px",this.decorator.style.backgroundColor="#f2f2f2",this.decorator.style.border="1px solid #cccccc",this.decorator.style.borderRadius="bottom"==this.posY.pos?"5px 5px 0px 0px":"0px 0px 5px 5px",this.contentDiv.style.margin="0px auto",this.contentDiv.style.bottom="2px"):(this.decorator.style.width=this.width+"px",this.decorator.style.height=
this.height+"px",this.contentDiv.style.position="absolute",this.contentDiv.style.top="0px");this.animString&&"vertical"==this.animation&&(this.decorator.style[this.animString]=this.posY.pos+" "+this.animeDur+"s",b[this.zone]||(this.decorator.style[this.posY.pos]=-1*this.height+"px",d.util.DOM.getElementCss(this.decorator)[this.posY.pos],this.decorator.style[this.posY.pos]=this.posY.dist+"px"));this.minimize()};this.animate=function(a){var b=this.decorator;if("grow"==this.animation)this.contentDiv.style.width=
this.iterations/this.animeIter*this.width+"px",this.contentDiv.style.height=this.iterations/this.animeIter*this.height+"px",this.updateClose(),this.iterations++>=this.animeIter&&(clearInterval(this.animeInterval),p&&p.sendViewportState());else if("vertical"==this.animation&&!this.animString)if(f)if(a){var e=parseInt(b.style[this.posY.pos].substr(0,b.style[this.posY.pos].length-2))+10;b.style[this.posY.pos]=e+"px";e>=this.posY.dist&&(f=!f,clearInterval(this.animeInterval),p&&p.sendViewportState())}else e=
parseInt(b.style[this.posY.pos].substr(0,b.style[this.posY.pos].length-2))-10,b.style[this.posY.pos]=e+"px",e<=-1*this.height-10&&(f=!f,clearInterval(this.animeInterval),p&&p.sendViewportState());else{f=!f;var h=this;this.animeInterval=setInterval(function(){h.animate(a)},1E3*(this.animeDur/this.animeIter))}else"horizontal"==this.animation&&(this.animString?(b.style[this.animString]=this.posX.pos+" "+this.animeDur+"s",b.style[this.posX.pos]=-1*this.width+"px",d.util.DOM.getElementCss(b)[this.posX.pos],
b.style[this.posX.pos]=this.posX.dist+"px"):f?(e=parseInt(b.style[this.posX.pos].substr(0,b.style[this.posX.pos].length-2))+10,b.style[this.posX.pos]=e+"px",e>=this.posX.dist+(d.util.viewport.width()-c.substring(0,c.length-2))/2&&(clearInterval(this.animeInterval),p&&p.sendViewportState())):(f=!f,b.style[this.posX.pos]=-1*this.width+"px",h=this,this.animeInterval=setInterval(function(){h.animate()},1E3*(this.animeDur/this.animeIter))))};this.forceTop=function(a){var b=document.getElementsByTagName("*"),
c;for(c in b){var e=b[c],g=d.util.DOM.getElementCss(e);g&&2147483646==g.zIndex&&(e.style.zIndex="2147483645!important")}a.style.zIndex="2147483646!important"};this.show=function(){this.decorator.style.display="block";var a=this;this.toggled&&(this.border&&this.maximize(),p&&p.sendViewportState());this.started=!0;this.timeout&&(this.displayTimeout=setTimeout(function(){a.close()},1E3*this.timeout))};this.close=function(){var a=this.decorator;a.style.display="none";if("true"==this.reOpen){this.contentDiv.style.display=
"none";var b=this;window.setTimeout(function(){b.replacer?(b.started=!1,b.checkView()):d.zone.getZone(b.zone).nextBanner()},2E4)}else this.replacer?this.started=!1:(this.displayTimeout&&clearTimeout(this.displayTimeout),a.parentNode.removeChild(a),this.shadowDiv&&this.shadowDiv.parentNode.removeChild(this.shadowDiv),d.zone.deleteZone(this.zone));p&&p.sendViewportState();this.isVisible=!1};this.shadowOverlay=function(){if(this.shadowDiv){this.shadowDiv=document.createElement("DIV");this.contentDiv.style.zIndex=
this.zIndex-1;this.shadowDiv.style.background="#000000";this.shadowDiv.style.opacity="0.6";this.shadowDiv.style.position="absolute";this.shadowDiv.style.top=0;this.shadowDiv.style.bottom=0;this.shadowDiv.style.left=0;this.shadowDiv.style.right=0;this.shadowDiv.setAttribute("id","shadow");document.body.appendChild(this.shadowDiv);var a=this;d.util.bind(this.shadowDiv,"click",function(){a.shadowDiv.parentNode.removeChild(a.shadowDiv);a.shadowDiv=null})}};this.createHeader=function(){if(this.border){var a=
this,c=document.createElement("DIV");c.style.width=this.width+"px";c.style.margin="0px auto";c.style.height="20px";c.style.position="relative";var e=document.createElement("IMG");e.src="http://images.webspectator.com/logo.png";e.style.width="16px";e.style.paddingTop="2px";e.style.display="inline";c.appendChild(e);e=document.createElement("IMG");e.src="bottom"==this.posY.pos?"http://images.webspectator.com/btn_fechar.png":"http://images.webspectator.com/btn_expandir.png";e.style.paddingTop="6px";e.style.paddingLeft=
"2px";e.style.right="0px";e.style.width="9px";e.style.position="absolute";e.style.cursor="pointer";this.toggled=!b;d.util.bind(e,"click",function(){a.toggle()});c.appendChild(e);this.animString&&(this.decorator.style[this.animString]="bottom "+this.animDur+"s");d.util.bind(this.decorator,this.transEvent,function(){p&&p.sendViewportState()});this.toggleImg=e;return c}this.closeDiv=document.createElement("DIV");this.closeDiv.style.zIndex=this.zIndex+1;this.closeDiv.style.position="relative";this.closeDiv.innerHTML=
"<img style='width=100%; align:right;' src = 'http://images.webspectator.com/close.png'></img>";this.updateClose();a=this;d.util.bind(this.closeDiv,"click",function(){a.close()});return this.closeDiv};this.maximize=function(){this.toggleImg.src="bottom"==this.posY.pos?"http://images.webspectator.com/btn_fechar.png":"http://images.webspectator.com/btn_expandir.png";d.util.DOM.getElementCss(this.decorator)[this.posY.pos];this.contentDiv.style.display="block";this.animString?this.decorator.style[this.posY.pos]=
this.posY.dist+"px":this.animate(!0)};this.minimize=function(){this.toggleImg.src="bottom"==this.posY.pos?"http://images.webspectator.com/btn_expandir.png":"http://images.webspectator.com/btn_fechar.png";this.decorator.style.top="";this.contentDiv.style.display="none";this.animString?this.decorator.style[this.posY.pos]=-1*this.decorator.style.height.substring(0,this.decorator.style.height.length-2)+20+"px":this.animate(!1)};this.toggle=function(){(this.toggled=!this.toggled)?(d.util.cookies.eraseCookie("ws-obp"),
this.maximize()):(d.util.cookies.createCookie("ws-obp",1,5/1440),this.minimize());p&&p.sendViewportState()};this.checkView=function(){var a=!1;for(z in this.replacer){var b=d.zone.getZone(this.replacer[z]);if(b&&(this.repDist?(a="top"==this.posY.pos?this.posY.dist+d.util.viewport.scrollTop():d.util.viewport.height()-this.posY.dist-this.height+d.util.viewport.scrollTop(),a=a<b.top+b.height+this.repDist&&a>b.top-this.repDist-this.height&&b.currView):a=b.currView,a))break}a&&p&&p.isFocused()?(this.decorator.style.display=
"none",this.toggled&&this.minimize(),p&&p.sendViewportState(),this.isVisible=!1):!a&&(!this.isVisible&&p&&p.isFocused())&&(this.started?(this.show(),this.isVisible=!0):(b=d.zone.getZone(this.zone),2>b.isOverlay.retries&&(b.isOverlay.retries++,b.nextBanner())))};this.contentDiv=document.createElement("DIV");this.decorator=document.createElement("DIV");this.contentDiv.setAttribute("data-pid",this.zone);var h=this.createHeader();this.setCss();this.shadowOverlay();"bottom"==this.posY.pos?(this.decorator.appendChild(h),
this.decorator.appendChild(this.contentDiv)):(this.decorator.appendChild(this.contentDiv),this.decorator.appendChild(h),h.style.bottom="0px",this.contentDiv.style.marginTop="10px",h.style.position="absolute",h.style.left="10px");this.contentDiv.style.display="none";document.body.appendChild(this.decorator);this.repositionDiv=function(){var a=this.posX.dist+(d.util.viewport.width()-c.substring(0,c.length-2));this.decorator.style[this.posX.pos]=0<a?a/2+"px":a+"px"};if(c){var j=this;d.util.bind(window,
"resize",function(){j.repositionDiv()})}this.replacer&&(j=this,this.repDist&&(d.events.listen(d.events.eventType.scroll,j.checkView,j),d.events.listen(d.events.eventType.resize,j.checkView,j)),d.events.listen(d.events.eventType.bannerInTentative,j.checkView,j),d.events.listen(d.events.eventType.bannerOut,j.checkView,j),d.events.listen(d.events.eventType.focus,j.checkView,j))};this.init=function(){c=JSON.parse(d.getParam("obc","overlaybannercontainer","{}"));c.type||(c=0);"id"==c.type&&(c=d.util.DOM.getElementCss(document.getElementById(c.value)).width);
"class"==c.type&&(c=d.util.DOM.getElementCss(document.getElementsByClassName(c.value)[0]).width);var b=!1,g="transition",f="transitionend",h=["webkit","Moz","O","MS","Khtml"],j="";"undefined"!=typeof document.body.style.transition&&(b=!0);if(!1===b)for(j=0;j<h.length;j++)if(void 0!==document.body.style[h[j]+"Transition"]){j=h[j];g=j+"Transition";f=g+"End";b=!0;break}a=JSON.parse(d.getParam("obp","overlayBannerParameters","[]"),c);for(j=a.length;j--;){var k=a[j],h=!0;if(k.dep){var h=!1,n=k.dep.split(","),
l=d.zone.zones(),m;for(m in l)if(h=-1<n.indexOf(l[m].id))break}if(k.ndep&&h){var n=k.ndep.split(","),p;for(p in n)if(d.zone.getZone(n[p])){h=!1;break}}h&&(b&&(k.animString=g,k.transEvent=f),h=new this.overlayBanner(k,c),n=d.zone.createZone(h.zone,h.contentDiv,{InitializeInView:!1}),n.isOverlay=h,k.replacer?n.isOverlay.checkView():function(a){window.setTimeout(function(){a.nextBanner()},k.delay||0)}(n))}s.log("init overlay")}}(s),zd=new function(){var a,b,c,e;this.sideBanner=function(g){this.id=g.id;
this.side=g.side||"right";this.width=g.width||160;this.height=g.height||600;this.ratio=g.visib||0.5;this.currPos=0;this.dep=g.dep;this.ndep=g.ndep;this.offset=g.offset||0;this.maxScroll=g.maxScroll;this.top;this.element;this.findPosition=function(){for(var b=a.offsetLeft,c=a;c.offsetParent&&"BODY"!=c.offsetParent.nodeName.toUpperCase();)c=c.offsetParent,b+=c.offsetLeft;return"left"==this.side?b-this.width-10+this.offset:b+10+d.util.DOM.getElementWidth(a)+this.offset};this.checkPosition=function(){this.maxScroll&&
this.maxScroll<d.util.viewport.scrollTop()?3!=this.currPos&&(this.currPos=3,this.element.style.position="absolute",this.element.style.top=this.maxScroll+"px"):d.util.viewport.scrollTop()<this.top&&1!=this.currPos?(this.element.style.position="absolute",this.element.style.top=this.top+"px",this.currPos=1):d.util.viewport.scrollTop()>=this.top&&2!=this.currPos&&(this.element.style.position="fixed",this.element.style.top="0px",this.currPos=2)};this.showAdZone=function(){if(this.element)this.element.style.display=
"block";else{this.element=document.createElement("DIV");document.body.appendChild(this.element);this.element.style.width=this.width+"px";this.element.style.height=this.height+"px";"left"==this.side?(this.top=b,b+=this.height+5):(this.top=c,c+=this.height+5);if("absolute"==e)this.element.style.position="absolute",this.element.style.top=this.top+"px";else{var a=this;window.attachEvent?window.attachEvent("onscroll",function(){a.checkPosition()}):window.addEventListener("scroll",function(){a.checkPosition()});
this.checkPosition()}var g=d.zone.createZone(this.id,this.element,{InitializeInView:!0});g.sideBanner=!0;g.nextBanner()}p&&p.sendViewportState()};this.hideAdZone=function(){this.element&&(this.element.style.display="none",p&&p.sendViewportState())};this.reposition=function(){var a=this.findPosition();this.element.style.left=a+"px"};this.fits=function(){return this.findPosition()>-1*this.width*(1-this.ratio)&&this.findPosition()<d.util.viewport.width()-this.width*this.ratio};this.onResize=function(){this.fits()?
(this.showAdZone(),this.reposition()):this.hideAdZone()};g=!0;if(this.dep){var g=!1,f=this.dep.split(","),h=d.zone.zones(),j;for(j in h)if(g=-1<f.indexOf(h[j].id))break}if(this.ndep&&g){j=this.ndep.split(",");for(var k in j)if(d.zone.getZone(j[k])){g=!1;break}}g&&(this.onResize(),d.events.listen(d.events.eventType.resize,this.onResize,this))};this.init=function(){var g=JSON.parse(d.getParam("sbp","sideBannerParameters","{}"));if(g.dockId)if(a=document.getElementById(g.dockId),b=c=g.top||0,e=g.sticky||
"dynamic",a)for(var f=0;f<g.zones.length;f++)new this.sideBanner(g.zones[f]);else s.log("sidebanner dock element not found")}}(s),Ad=new function(){var a;this.stickyBanner=function(b){var c=d.zone.getZone(b),e=c.top,g=c.left,f=c.element.style.position,h=""==c.element.style.left?0:parseInt(c.element.style.left.substring(0,c.element.style.left.length-2)),j=c.element.style.top,k=c.element.parentNode,n=!1,l=document.createElement("IMG"),m=!1,b=function(){!m&&!n&&d.util.viewport.scrollTop()+a>=e?(c.element.style.position=
"fixed",c.element.style.left=g+"px",c.element.style.top=a+"px",n=!0,l.style.display="block"):!m&&(n&&d.util.viewport.scrollTop()+a<e)&&(c.element.style.position=f,c.element.style.left=h,c.element.style.top=j,n=!1,l.style.display="none")};l.src="http://images.webspectator.com/close.png";l.setAttribute("class","wsOverlay");l.style.zIndex=2147483647;l.onclick=function(){c.element.style.position=f;c.element.style.left=h;c.element.style.top=j;n=!1;l.style.display="none";m=!0};l.style.top="0px";l.style.right=
"-10px";l.style.position="absolute";l.style.display=n?"block":"none";c.element.appendChild(l);window.attachEvent?window.attachEvent("onscroll",b):window.addEventListener("scroll",b);d.events.listen(d.events.eventType.resize,function(){var a=k.offsetLeft+h,b=d.util.DOM.getElementCss(k);if(b.position&&"fixed"==b.position)a+=scrollLeft;else for(b=k;"HTML"!=b.nodeName&&b.offsetParent;){var b=b.offsetParent,e=d.util.DOM.getElementCss(b);if(e.position&&"fixed"==e.position){a+=scrollLeft+b.offsetLeft;break}a+=
b.offsetLeft}g=a;n&&(c.element.style.left=g+"px")})};this.init=function(){var b=JSON.parse(d.getParam("lsz","listStickyZones","{}"));a=b.top||0;if(b.zones)for(var c=0;c<b.zones.length;c++)new this.stickyBanner(b.zones[c])}}(s);s.init=function(){fa=l.messaging;p=l.tracking;s.log("init display")};s.reset=function(){ya.reset()};s.ready=function(){d.globalParameters.scriptInFrameOn||(fc.init(),zd.init(),Ad.init());wd.init();vd.init();fb.init();ec.init();yd.init();xd.init();s.log("ready display")};Yb=
d.getParam("bdt","bannerDisplayTime",2E4);Xb=d.getParam("tlo","timerLoopEventOn",!0,!0);Zb=d.getParam("rbd","requestBannerRetryDelayMs",2E3);d.getParam("sbv","sendBitInViewOn",!1,!0);eb=d.getParam("rbr","requestBannerMaxRetries",1);dc=d.getParam("rsm","cbReqScriptMode",1);$b=d.getParam("ubv","updateBannerOnView",!0,!0);ac=d.getParam("uve","updateBannerOnViewExceptions","").split(",");bc=d.getParam("tsg","gtsTrackerServerOn",!1,!0);cc=d.getParam("orz","oneRotationZones","").split(",");La=d.getParam("coe",
"closeOnEmpty",!0,!0);d.events.listen(d.events.eventType.bannerIn,function(a){s.log("banner in view: "+a.bannerId+" in zone: "+a)});d.events.listen(d.events.eventType.bannerInTentative,function(a){s.log("banner in tentative view: "+a.bannerId+" in zone: "+a);if(a.updateOnView){var b=a.updateOnView.entry,c=a.updateOnView.cb;a.updateOnView=null;a.updateBanner(b,c)}else a.bitPayload&&(fa&&fa.sendImpressionNotification(a.bitPayload),a.bitPayload=null)});d.events.listen(d.events.eventType.bannerOut,function(a){s.log("banner out view: "+
a.bannerId+" in zone: "+a)});d.events.listen(d.events.eventType.bannerPrint,function(a){s.log("onBannerPrint\n"+a);p&&p.sendViewportState();a.fp&&(a.fp=!1);d&&d.util.raiseEvent(d.util.scriptEvents.zoneStatusChanged,{action:"bannerChanged",zone:a})});d.events.listen(d.events.eventType.messageReceived,function(a){d.globalParameters.trackIdleOn&&p&&p.isUserIdle()?(gb.push(a),s.log("user idle: message enqueued")):jc(a)});d.events.listen(d.events.eventType.bannerResize,function(a){var b=d.zone.getZone(a.zone);
b.width=a.width;b.height=a.height;document.getElementById(a.id).style.width=b.width+"px";document.getElementById(a.id).style.height=b.height+"px";0.01!=a.left&&(document.getElementById(a.id).style.left=a.left+"px");d.events.emit("zoneSizeUpdate",b)});d.events.listen(d.events.eventType.frameLoaded,function(a){var b=d.zone.getZone(a.element.getAttribute("data-pid"));b.isOverlay&&(b.isOverlay.replacer?(b.isOverlay.started=!0,b.isOverlay.checkView()):b.isOverlay.show());"function"==typeof a.cb&&a.cb()});
var A=d.zone.getPrototype();A.rotations=0;A.displayTrackingHnd=null;A.fetchingBanner=!1;A.autoUpdateOn=!1;A.autoUpdateQueueOn=!1;A.updateCount=0;A.bannerEnteredView=!1;A.bannerInViewMessage=null;A.queue=null;A.categories=null;A.bannerTimer=null;A.processingBanner=!1;A.bitPayload=null;A.calculateVisibleTime=function(a){return this.visibleTime+((a||+new Date)-this.bannerTimer.startTime())};A.calculateZoneVisibleTime=function(a){return this.zoneVisibleTime+((a||+new Date)-this.zoneTimer.startTime())};
A.calculatePartialVisibleTime=function(a){return(a||+new Date)-this.bannerTimer.startTime()};A.calculatePartialZoneVisibleTime=function(a){return(a||+new Date)-this.zoneTimer.startTime()};A.initDisplayZone=function(){for(var a,b=0;b<this.element.childNodes.length;b++){var c=this.element.childNodes[b].tagName;c&&"SCRIPT"!=c&&(a=b)}this.fp?this.nextBanner({campaignId:this.campaignId}):this.queue.add(this.bannerEntry.create({bannerId:this.bannerId,campaignId:this.campaignId||0,html:this.element.innerHTML,
displayTime:this.displayTime,gtsTrackerUrl:this.gtsTrackerUrl,node:a}),null,!0);this.queue.dump("initial queue dump")};A.bannerFetched=function(a){this.log("banner fetched for zone "+this.id);var b;null==(b=this.queue.get(a.entryId))?this.log("entry not found with index: "+a.entryId):a.entryId<this.queue.index()?this.log("entry index is less than current queue index"):b.fetchingBanner?(b.retriesHnd&&(this.log("clear entry.retriesHnd: "+b.retriesHnd),clearTimeout(b.retriesHnd)),b.requestEndTs=a.created,
b.requestDurationMs=b.requestEndTs-b.requestBeginTs,this.bannerEntry.extend(b,a,!b.forceEntryOptions),this.log("updated entry from banner fetched:"+b),b.bannerUpdatePending?(this.nextBanner(null,b,function(){b.fetchingBanner=!1}),b.bannerUpdatePending=!1):b.fetchingBanner=!1):this.log("entry not fetching banner:"+b.toString())};A.isFetchingCurrentBanner=function(){return this.queue.getCurrent().fetchingBanner};A.nextBanner=function(a,b,c){if(!this.locked){var e=this;this.processingBanner=!0;b||(b=
this.queue.getNext());null==b&&(this.log("queue empty"),b=this.bannerEntry.create({zoneId:this.id}),this.bannerEntry.extend(b,a),this.queue.add(b,null,!0),b.bannerUpdatePending=!0);if(b.html)b.oneUpdate&&this.decOneUpdate(),a=function(){c&&c();e.processingBanner=!1},!$b||-1<ac.indexOf(this.id)||this.currView||this.isOverlay&&this.isOverlay.toggled||this.decoratorStickyBanner&&this.decoratorStickyBanner.checkCampaign(b.campaignId)?this.updateBanner(b,a):(this.isOverlay&&this.isOverlay.show(),this.updateOnView=
{entry:b,cb:a});else{if(b.fetchingBanner){this.throttlingBannerUpdate=!0;this.log("enable throttling banner update in zone "+this.id);var g=this;setTimeout(function(){g.throttlingBannerUpdate=!1;g.log("disable throttling banner update in zone "+g.id)},5E3)}else hc(this,b);this.processingBanner=!1;c&&c()}}};A.updateBanner=function(a,b){this.log("updatebanner "+this);var c=this.queue.getPrevious(),e=this.queue.getCurrent(),e=this.bannerEntry.extend(e,a),g=this,d=e,f=function(){var d=g.updateBannerEnd(c,
e);c&&(c.visibleTime=d.visibleTime,c.partialVisibleTime=d.partialVisibleTime);for(d=0;d<g.element.childNodes.length;d++){var f=g.element.childNodes[d],h=1==f.nodeType?f.getAttribute("class"):null;1==f.nodeType&&("SCRIPT"!=f.nodeName&&!(h&&-1<h.split(" ").indexOf("wsOverlay")))&&(!f.getAttribute("visibid")&&c&&f.setAttribute("visibid",c.visibId),"none"!=f.style.display&&f.getAttribute("visibid")!=e.visibId&&(f.style?"none"!=f.style.display&&(f.style.display="none"):f.setAttribute("style","display:none")))}"r"==
a.mode&&(d=g.bannerEntry.clone(c),"undefined"!=typeof d.mode&&delete d.mode,g.incOneUpdate(),d.oneUpdate=!0,g.queue.addToHead(d));"function"==typeof b&&b()};s.log("setContentFrame");var h;h="<html><head>"+("<script type='text/javascript'>function resizeFrame(id, firstpass) {var matchRegex = function (str, re, matchIndex) {var ret = null;var matches = str.match(re);if (matches != null && matchIndex < matches.length)ret = matches[matchIndex];return ret;};var regWidth = new RegExp('data-bannerWidth=(?:\\'|\\\")([^(\\'|\\\")]*)(?:\\'|\\\")');var regHeight = new RegExp('data-bannerHeight=(?:\\'|\\\")([^(\\'|\\\")]*)(?:\\'|\\\")');var width, height;width = matchRegex(document.body.innerHTML, regWidth, 1);height = matchRegex(document.body.innerHTML, regHeight, 1);window.minWidth = parseInt(width)||0;window.minHeight = parseInt(height)||0;var size = checkResize();width = size[0] > width ? size[0] : width;height = size[1] > height ? size[1] : height;left = size[2];if (width && width > 0 && height && height > 0 && (width != window.frameElement.style.width.substring(0, window.frameElement.style.width.length - 2) || height != window.frameElement.style.height.substring(0, window.frameElement.style.height.length - 2) ||left != window.frameElement.style.left.substring(0, window.frameElement.style.left.length - 2))) {app.core.events.emit('bannerResize', { zone: window.frameElement.getAttribute('data-pid'), id: id, width: width, height: height, left: left });}else if (firstpass && document.body.scrollHeight && document.body.scrollWidth) {app.core.events.emit('bannerResize', { zone: window.frameElement.getAttribute('data-pid'), id: id, width: document.body.scrollWidth, height: document.body.scrollHeight, left: left });}};function checkResize(node, currWidth, currHeight, currLeft) {if (!node) {node = document.body;var currWidth = 0, currHeight = 0, currLeft = 0;} else {if (node.onpropertychange == null && node.attachEvent && node.getAttribute && !node.getAttribute('hasHandler')) {node.attachEvent('onpropertychange', onPropChangeHdl);node.setAttribute('hasHandler', '1');}if (node.style && node.style.width.length > 2 && (!currWidth || node.style.position == 'absolute')) currWidth = node.style.width.substring(0, node.style.width.length - 2);if (node.style && node.style.height.length > 2 && (!currHeight || node.style.position == 'absolute')) currHeight = node.style.height.substring(0, node.style.height.length - 2);if (node.style && node.style.left.length > 2 && !currLeft){currLeft = node.style.left.substring(0, node.style.left.length - 2);if (node.style.left != '0.01px') {node.style.left = '0.01px';}}}for (var i = 0; i < node.childNodes.length; i++) {var res = checkResize(node.childNodes[i], currWidth, currHeight, currLeft);if (!currWidth || (res[0] && parseInt(res[0]) > parseInt(currWidth)))currWidth = res[0];if (!currHeight || (res[1] && parseInt(res[1]) > parseInt(currHeight)))currHeight = res[1];if ((!currLeft || (res[2] && parseInt(res[2]) > parseInt(currLeft)))&&parseInt(currHeight) >= window.minHeight && parseInt(currWidth) >= window.minWidth)currLeft = res[2];}return [currWidth, currHeight, currLeft];}function onPropChangeHdl(event) {if (event.srcElement.style.visibility != 'hidden') {resizeFrame(window.frameElement.id);}};function start() {app.core.events.emit('frameLoaded', {element: window.frameElement, cb: window.cb});if (window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver) {var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;var observer = new MutationObserver(function (mutations) {if (window.frameElement.style.visibility != 'hidden')resizeFrame(window.frameElement.id);});observer.observe(document.body, { attributes: true, childList: true, subtree: true, attributeFilter: ['style'] });} else if (document.body && document.body.attachEvent != null) {function addEvent(node) {if (node.attachEvent) {node.attachEvent('onpropertychange', onPropChangeHdl);node.setAttribute('hasHandler','1');}for (var i = 0; i < node.childNodes.length; i++) {addEvent(node.childNodes[i]);}}addEvent(document.body);} else {setInterval(function () {if (window.frameElement.style.visibility != 'hidden')resizeFrame(window.frameElement.id);}, 500);}resizeFrame(window.frameElement.id, 1);};<\/script></head><body style='margin:0px;overflow:hidden'><script>"+
d.html+"<\/script><script>var starter = setInterval(function(){if(window.app){clearInterval(starter);start()}},1000)<\/script></body></html>");if(d.node||0==d.node)for(h=0;h<this.element.childNodes.length;h++){var k=this.element.childNodes[h];1==k.nodeType&&("SCRIPT"!=k.nodeName&&k.hasAttribute("visibid")&&k.getAttribute("visibid")==d.visibId)&&(k.style.display="block")}else{k=document.createElement("div");k.style.position="relative";k.setAttribute("visibid",d.visibId);var n=document.createElement("iframe");
n.style.border="none";n.id="bannerframe"+d.bannerId+ +new Date;n.async="true";n.frameBorder="no";n.style.overflow="visible";n.style.position="relative";n.style.zIndex=2147483647;n.style.left="0px";n.style.top="0px";n.style.height="0px";n.style.width="0px";n.setAttribute("data-pid",this.id);k.appendChild(n);this.element.appendChild(k);for(d.node=0;null!=(k=k.previousSibling);)d.node++;n.contentWindow.contents=h;n.src='javascript:window["contents"]';window.attachEvent?n.onreadystatechange=function(){n.contentWindow.app||
(n.contentWindow.app=l,n.contentWindow.cb=f)}:n.addEventListener("load",function(){n.contentWindow.app=l;n.contentWindow.cb=f});h=n.contentWindow.location.href;-1==navigator.userAgent.indexOf("Firefox")&&"#"==h.charAt(h.length-1)&&n.contentWindow.location.replace(h+"null");this.wsOwner=!0;this.overlayData&&this.overlayData.addEntry(new Date(parseInt(d.visibId.substring(0,d.visibId.length-3))))}};A.updateBannerEnd=function(a,b){var c=+new Date,e=this.calculatePartialVisibleTime(c),g=this.setVisibleTime(e);
this.bannerTimer.stop(c);this.bannerTimer.start(c);this.bannerId=b.bannerId;this.campaignId=b.campaignId;this.impressionId=b.impressionId||0;this.displayTime=b.displayTime;this.visibleTime=b.visibleTime||0;this.remnant=b.remnant;this.log("updated zone "+this+" with banner data: "+JSON.stringify(b));this.currView&&(d.events.emit(d.events.eventType.bannerOut,this,a),this.bannerEnteredView=!0,d.events.emit(d.events.eventType.bannerInTentative,this,b));d.events.emit(d.events.eventType.bannerPrint,this,
{timeStamp:c});return{partialVisibleTime:e,visibleTime:g}};A.updateBannerMarkup=function(a){this.element.innerHTML=a};A.incOneUpdate=function(){this.updateCount+=1};A.decOneUpdate=function(){this.updateCount-=1};A.changeBanner=function(a){this.log("changebanner :"+this);a.zoneId=this.id;a=this.bannerEntry.create(a);a.bannerUpdatePending=!0;this.queue.addToHead(a);this.nextBanner()};A.addBanner=function(a){var b=this.bannerEntry.create(a);this.queue.add(b);a.fetchBanner&&hc(this,b)};A.bannerEntry=
new function(){this.create=function(a){var b={toString:function(){return JSON.stringify(this)}},b=this.extend(b,a);b.visibId=+new Date+""+Math.floor(1E3*Math.random());return b};this.extend=function(a,b,c){"undefined"==typeof c&&(c=!0);for(var e in b)if(null!=b[e]&&(c||"undefined"==typeof a[e]))a[e]=b[e];return a};this.clone=function(a){return this.extend({},a)};this.dummy=function(){return this.create({id:0,html:"<dummy/>",displayTime:0})}};A.setCategoriesHint=function(a){this.categories=null==a?
[]:"string"===typeof a?[].push(a):a};d.extension.add("tracking.upgradeFromTentativeView",function(a){s.log("upgradeFromTentativeView: "+a);a.bannerEnteredView&&(a.bannerEnteredView=!1,d.events.emit(d.events.eventType.bannerIn,{zone:a,bannerId:a.bannerId}))});d.extension.add("tracking.inTentativeView",function(a,b){return b||a.bannerEnteredView});d.extension.add("core.zone.start",function(){this.initDisplayZone();this.log("startDisplay")});d.extension.add("core.zone.del",function(a){this.currView&&
(a=this.bannerTimer.stop(a),this.setVisibleTime(a),d.events.emit(d.events.eventType.bannerOut,this,{inTentativeView:this.bannerEnteredView,visibleTime:a}));clearInterval(this.displayTrackingHnd);this.log("delDisplay")});d.extension.add("core.zone.getdata",function(a){a.bannersQueue={};a.bannersQueue.queue=this.queue.getData();a.bannersQueue.currentIndex=this.queue.index();return a});d.extension.add("tracking.intoview",function(a){this.bannerTimer.start(a.timeStamp);this.bannerEnteredView=!0;d.events.emit(d.events.eventType.bannerInTentative,
this,a)});d.extension.add("tracking.outofview",function(a){var b=this.bannerTimer.stop(a.timeStamp);this.setVisibleTime(b);this.bannerEnteredView=!1;d.events.emit(d.events.eventType.bannerOut,this,a)});d.extension.add("core.zone.tostring",function(a,b){b.fetchingBanner=a.fetchingBanner;b.autoUpdateOn=a.autoUpdateOn;b.autoUpdateQueueOn=a.autoUpdateQueueOn;b.updateCount=a.updateCount;b.bannerEnteredView=a.bannerEnteredView;b.bannerTimer=JSON.stringify(a.bannerTimer.toJSON());return b});d.extension.add("core.zone.init",
function(){var a=this;this.updateCount=0;this.displayTime=Yb;this.bannerTimer=new d.util.PartialTimer;this.queue=new function(a){var c=[],e=-1;this.clear=function(){c=[]};this.dump=function(g){var d=c.length;g&&a.log(g+"\n");a.log("banner's queue dump (size:"+d+", index:"+e+"):\n");for(g=0;g<d;g++)a.log((g===e?">>>":"")+" ("+g+"): "+c[g]+"\n");a.log("found "+d+" entries in queue")};this.index=function(){return e};this.get=function(a){return c[a]};this.add=function(a,b,d){b?c.splice(b,0,a):c.push(a);
a.index=b?b:c.length-1;d&&(e+=1)};this.addToHead=function(a){var b=e+1;this.add(a,b);a.index=b};this.getCurrent=function(){return c[e]};this.setCurrent=function(a){c[e]=a};this.getNext=function(){return e+1<c.length?(e+=1,c[e]):null};this.getPrevious=function(){return c[e-1]};this.setPrevious=function(a){c[e-1]=a};this.isEmpty=function(){return 0==c.length};this.isQueueEmpty=function(){return e+1==c.length};this.getData=function(){return c}}(this);Xb&&(this.displayTrackingHnd=setInterval(function(){ya.signal(a)},
10));this.log("initDisplay")});d.register("display",s,{});var ha={},H=l.core,kc,t,lc,za=[],Aa=[],F,hb=!0;H.register("analyticszones",ha,{});var Bd=function(){for(var a={},b=0;b<arguments.length;b++){var c=arguments[b],e;for(e in c)a[e]=c[e]}return a},mc=function(a){var b;b=void 0;b={threshold:0};if(b=!(H.util.viewport.width()+H.util.viewport.scrollLeft()<=a.left-b.threshold)&&!(H.util.viewport.scrollLeft()>=a.left+a.width-b.threshold)&&!(H.util.viewport.height()+H.util.viewport.scrollTop()<=a.top-
b.threshold)&&!(H.util.viewport.scrollTop()>=a.top+a.height-b.threshold)){var c=a.width,e=a.height,d=a.top,f=a.left,h=H.util.viewport.scrollLeft(),j=H.util.viewport.scrollTop(),k=H.util.viewport.height(),l=H.util.viewport.width(),l=h+l,k=j+k,m=0,p=m=0;d>=j&&d+e<=k&&f>=h&&f+c<=l?m=100:d+e<j||d>k||f+c<h||f>l?m=0:(d>=j&&d+e<=k?m=e:d<j?m=d+e-j:d<k&&(m=k-d),f>=h&&f+c<=l?p=c:f<h?p=f+c-h:f<l&&(p=l-f),m=Math.round(100*(m*p/(e*c))));a.visiblePercentage=m}return b},Cd=function(a,b){var c=Math.round(16777215*
Math.random());switch(a){case "hex":return("#0"+c.toString(16)).replace(/^#0([0-9a-f]{6})$/i,"#$1");case "rgb":return"rgb("+(c>>16)+","+(c>>8&255)+","+(c&255)+")";case "rgba":return"rgba("+(c>>16)+","+(c>>8&255)+","+(c&255)+","+b+")";default:return c}},nc=function(){var a=(new Date).getTime();za=[];Aa=[];F.style.zIndex=t.zIndex;var b=t.zoneHeight+"px";H.util.viewport.width();H.util.viewport.height();for(var c=Math.max(Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),Math.max(document.body.offsetHeight,
document.documentElement.offsetHeight),Math.max(document.body.clientHeight,document.documentElement.clientHeight)),e=Math.max(Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),Math.max(document.body.clientWidth,document.documentElement.clientWidth)),d;F.hasChildNodes();)F.removeChild(F.lastChild);if(t.viewport)if("object"!=typeof t.viewport){d=document.getElementById(t.viewport);for(var e=d.offsetLeft,
f=d;f.parentNode&&"BODY"!=f.parentNode.nodeName.toUpperCase();)f=f.parentNode,e+=f.offsetLeft;F.style.position="absolute";F.style.top="0px";F.style.display="block";F.style.height=c+"px";d=H.util.DOM.getElementCss(d).width;F.style.width=d;F.style.left=e+"px";d=parseInt(d.substring(0,d.indexOf("p")))}else{F.style.position="absolute";F.style.top="0px";F.style.display="block";F.style.height=c+"px";F.style.width=e+"px";for(d in t.viewport)F.style[d]=t.viewport[d];d=parseInt(F.style.width.substring(0,F.style.width.indexOf("p")))}else F.style.position=
"absolute",F.style.top="0px",d=e,F.style.height=c+"px",F.style.width=d+"px";t.drawZonesonScreen&&document.body.appendChild(F);"auto"==t.numColsType?(t.numCols=Math.floor(d/t.zoneWidth),e=t.zoneWidth+"px"):(e=Math.floor(d/t.numCols)+"px",t.zoneWidth=Math.floor(d/t.numCols));d=t.numCols;for(var c=Math.floor(c/t.zoneHeight)+1,h=f=0,j=0,k=0;k<c;k++){for(var l=0;l<d;l++){var m={id:f,top:h,left:j,width:t.zoneWidth,height:t.zoneHeight,cssWidth:e,cssHeight:b,gridPosition:[],inViewport:!1,visiblePercentage:0,
zonePositioningStyle:"absolute"};m.gridPosition=[l,k];za.push(m);ha.log("new tracking zone: "+JSON.stringify(m));j+=t.zoneWidth;f++;var p=t,r=F;if("true"==p.drawZonesonScreen.toString().toLowerCase()){var s=document.createElement("div");s.id="trackerZone"+m.id;s.setAttribute("id","trackerZone"+m.id);s.style.width=m.cssWidth;s.style.height=m.cssHeight;s.style.display="block";s.style.position=m.zonePositioningStyle;s.style.top=m.top+"px";s.style.left=m.left+"px";s.style.zIndex=p.zIndex;s.style.backgroundColor=
Cd("rgba",p.colorAlpha);r.appendChild(s)}}h+=t.zoneHeight;j=0}b=(new Date).getTime();ha.log("tracking zones generation - processing time (ms): "+parseInt(b-a))},qa,oc,pc,ib=function(a){a.focus=hb;a=Bd(t,a);clearTimeout(oc);Aa=[];for(var b=za,c=0;c<b.length;c++){var e=b[c];e.inViewport=mc(e)}for(b=0;b<za.length;b++)c=za[b],c.inViewport=mc(c),c.inViewport&&c.visiblePercentage>=a.zoneVisiblePercentage&&Aa.push(c);ha.log("# visible zones: "+Aa.length);b=Aa;a=a||{};a={trackingzoneIds:"",timestamp:a.ts||
+new Date,screenWidth:screen.width,currentLocationHint:self.currentLocationHint?self.currentLocationHint:self.currentLocationHref?self.currentLocationHref:window.location.href,focus:a.focus?1:0};if(0<b.length){c=bottomright=b[0];for(e=1;e<b.length;e++){var d=b[e];d.top<=c.top&&d.left<=c.left&&(c=d);d.top>=bottomright.top&&d.left>=bottomright.left&&(bottomright=d)}a.trackingzoneIds="gridPosition"==t.sendZoneInfoType?c.gridPosition.toString()+"-"+bottomright.gridPosition.toString():c.left+","+c.top+
"-"+(bottomright.left+t.zoneWidth)+","+(bottomright.top+t.zoneHeight)}a.trackingzoneIds+="["+t.zoneWidth+"*"+t.zoneHeight+"]";lc.sendTrackingZones(a);ha.log("sent tracking zones info:"+JSON.stringify(a));oc=setTimeout(function(){ib({ts:+new Date})},pc)};qa={start:function(a){pc=t.statusInterval||1E4;a&&ib({ts:+new Date})},update:ib};ha.init=function(){lc=l.messaging;ha.log("init analyticszones");if(kc){t=""==t?{}:JSON.parse(t);var a={};a.statusInterval=t.statusInterval||1E4;a.numColsType=t.numColsType||
"fixed";a.numCols=t.numCols||10;a.zoneWidth=t.zoneWidth||100;a.zoneHeight=t.zoneHeight||100;a.sendZoneInfoType=t.sendZoneInfoType||"gridPosition";a.zIndex=t.zIndex||-1;a.drawZonesonScreen=t.drawZonesonScreen||!1;a.colorAlpha=t.colorAlpha||0.45;a.zoneVisiblePercentage=t.zoneVisiblePercentage||80;a.viewport=t.viewport;t=a;F=document.createElement("DIV");nc();qa.start(!0);ha.log("started statusUpdater");H.events.listen(H.events.eventType.focus,function(a){hb=!0;qa.update({ts:a&&a.timeStamp?a.timeStamp:
+new Date})});H.events.listen(H.events.eventType.blur,function(a){hb=!1;qa.update({ts:a&&a.timeStamp?a.timeStamp:+new Date})});H.events.listen(H.events.eventType.scroll,function(){qa.update({ts:+new Date})});H.events.listen(H.events.eventType.resize,function(){nc();qa.update({ts:+new Date})})}};kc=H.getParam("tzg","trackZonesGridOn",!1,!0);t=H.getParam("zgo","zonesGridOptions","");var Na={},ia=l.core,qc,ra,rc=function(){qc||(ia.util.executeOnPredicate(function(){Na.log("loading quantcast frame with url: "+
ra);var a=document.createElement("iframe");a.setAttribute("style","display:none;width:0px;height:0px");a.id="wsqcast";a.async="true";a.src=ra+(-1<ra.indexOf("?")?"&":"?")+"cid="+encodeURIComponent(ia.globalParameters.publisherChannelId);a.frameBorder="no";document.body.appendChild(a)},function(){return document.body}),qc=!0)};Na.init=function(){var a=ia.getParam("qlc","quantcastloadOnOrtcConnect",!1,!0);ra=ia.getParam("qpu","quantcastPageUrl","");if(""!=(ra=ia.util.trim(ra)))a?ia.events.listen(ia.events.eventType.ortcConnected,
rc):rc();Na.log("init")};ia.register("quantcast",Na,{});var Oa={},jb=l.core,sc,tc=function(a){if("testInit"==a.data.msg)if(a.data.publicId!=jb.globalParameters.publicId){var a=a.data.publicId,b=document.createElement("div");b.setAttribute("style","position:fixed;top:0px;z-index:100000000;width:100%;text-align:center;background-color:black;color:yellow;left:0px;font-size:20px");b.innerHTML='Invalid application identifier found. Expected identifier is "<strong>'+a+'</strong>" but we found "<strong>'+
jb.globalParameters.publicId+'</strong>" instead.';document.body.appendChild(b)}else sc.toggleOverlay(a.data.adUnits)};Oa.init=function(){sc=l.tracking;Oa.log("init postmessage")};Oa.ready=function(){window.opener&&window.postMessage&&(window.attachEvent?window.attachEvent("onmessage",tc,!1):window.addEventListener("message",tc,!1),window.opener.postMessage("wsReady","*"))};jb.register("postmessage",Oa,{});var kb=l.core,Dd="undefined"==typeof window.WS_INIT?!0:window.WS_INIT,lb=function(){Dd&&kb.init()};
kb.InitOnLoad&&(kb.InitOnPageLoad&&"complete"!=document.readyState?window.addEventListener?window.addEventListener("load",lb,!1):window.attachEvent&&window.attachEvent("onload",lb):lb())})();
