/*Deployed at 19-08-2013 12:33*/
/* SockJS client, version 0.3.1, http://sockjs.org, MIT License

Copyright (c) 2011-2012 VMware, Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/
var JSON;JSON||(JSON={});
(function(){function k(c,j){var r,o,m,n,w=i,f,d=j[c];d&&typeof d=="object"&&typeof d.toJSON=="function"&&(d=d.toJSON(c));typeof q=="function"&&(d=q.call(j,c,d));switch(typeof d){case "string":return g(d);case "number":return isFinite(d)?String(d):"null";case "boolean":case "null":return String(d);case "object":if(!d)return"null";i+=v;f=[];if(Object.prototype.toString.apply(d)==="[object Array]"){n=d.length;for(r=0;r<n;r+=1)f[r]=k(r,d)||"null";m=f.length===0?"[]":i?"[\n"+i+f.join(",\n"+i)+"\n"+w+"]":
"["+f.join(",")+"]";i=w;return m}if(q&&typeof q=="object"){n=q.length;for(r=0;r<n;r+=1)typeof q[r]=="string"&&(o=q[r],m=k(o,d),m&&f.push(g(o)+(i?": ":":")+m))}else for(o in d)Object.prototype.hasOwnProperty.call(d,o)&&(m=k(o,d),m&&f.push(g(o)+(i?": ":":")+m));m=f.length===0?"{}":i?"{\n"+i+f.join(",\n"+i)+"\n"+w+"}":"{"+f.join(",")+"}";i=w;return m}}function g(c){j.lastIndex=0;return j.test(c)?'"'+c.replace(j,function(c){var g=C[c];return typeof g=="string"?g:"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)})+
'"':'"'+c+'"'}function c(c){return c<10?"0"+c:c}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+c(this.getUTCMonth()+1)+"-"+c(this.getUTCDate())+"T"+c(this.getUTCHours())+":"+c(this.getUTCMinutes())+":"+c(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var n=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
j=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i,v,C={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},q;typeof JSON.stringify!="function"&&(JSON.stringify=function(c,g,j){var o;i="";v="";if(typeof j=="number")for(o=0;o<j;o+=1)v+=" ";else typeof j=="string"&&(v=j);q=g;if(!g||typeof g=="function"||typeof g=="object"&&typeof g.length=="number")return k("",{"":c});throw Error("JSON.stringify");
});typeof JSON.parse!="function"&&(JSON.parse=function(c,g){function i(c,j){var k,f,d=c[j];if(d&&typeof d=="object")for(k in d)Object.prototype.hasOwnProperty.call(d,k)&&(f=i(d,k),f!==void 0?d[k]=f:delete d[k]);return g.call(c,j,d)}var j;c=String(c);n.lastIndex=0;n.test(c)&&(c=c.replace(n,function(c){return"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(c.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+c+")"),typeof g=="function"?i({"":j},""):j;throw new SyntaxError("JSON.parse");})})();
SockJS=function(){var k=document,g=window,c={},n=function(){};n.prototype.addEventListener=function(a,b){if(!this._listeners)this._listeners={};a in this._listeners||(this._listeners[a]=[]);var h=this._listeners[a];c.arrIndexOf(h,b)===-1&&h.push(b)};n.prototype.removeEventListener=function(a,b){if(this._listeners&&a in this._listeners){var h=this._listeners[a],e=c.arrIndexOf(h,b);e!==-1&&(h.length>1?this._listeners[a]=h.slice(0,e).concat(h.slice(e+1)):delete this._listeners[a])}};n.prototype.dispatchEvent=
function(a){var b=a.type,c=Array.prototype.slice.call(arguments,0);this["on"+b]&&this["on"+b].apply(this,c);if(this._listeners&&b in this._listeners)for(var e=0;e<this._listeners[b].length;e++)this._listeners[b][e].apply(this,c)};var j=function(a,b){this.type=a;if(typeof b!=="undefined")for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c])};j.prototype.toString=function(){var a=[],b;for(b in this)if(this.hasOwnProperty(b)){var c=this[b];typeof c==="function"&&(c="[function]");a.push(b+"="+c)}return"SimpleEvent("+
a.join(", ")+")"};var i=function(a){this.events=a||[]};i.prototype.emit=function(a){var b=Array.prototype.slice.call(arguments,1);!this.nuked&&this["on"+a]&&this["on"+a].apply(this,b);c.arrIndexOf(this.events,a)===-1&&c.log("Event "+JSON.stringify(a)+" not listed "+JSON.stringify(this.events)+" in "+this)};i.prototype.nuke=function(){this.nuked=!0;for(var a=0;a<this.events.length;a++)delete this[this.events[a]]};c.random_string=function(a,b){var b=b||37,c,e=[];for(c=0;c<a;c++)e.push("abcdefghijklmnopqrstuvwxyz0123456789_".substr(Math.floor(Math.random()*
b),1));return e.join("")};c.random_number=function(a){return Math.floor(Math.random()*a)};c.random_number_string=function(a){var b=(""+(a-1)).length;return(Array(b+1).join("0")+c.random_number(a)).slice(-b)};c.getOrigin=function(a){a+="/";return a.split("/").slice(0,3).join("/")};c.isSameOriginUrl=function(a,b){if(!b)b=g.location.href;return a.split("/").slice(0,3).join("/")===b.split("/").slice(0,3).join("/")};c.getParentDomain=function(a){return/^[0-9.]*$/.test(a)?a:/^\[/.test(a)?a:!/[.]/.test(a)?
a:a.split(".").slice(1).join(".")};c.objectExtend=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a};c.polluteGlobalNamespace=function(){"_jp"in g||(g._jp={})};c.closeFrame=function(a,b){return"c"+JSON.stringify([a,b])};c.userSetCode=function(a){return a===1E3||a>=3E3&&a<=4999};c.countRTO=function(a){return a>100?3*a:a+200};c.log=function(){g.console&&console.log&&console.log.apply&&console.log.apply(console,arguments)};c.bind=function(a,b){return a.bind?a.bind(b):function(){return a.apply(b,
arguments)}};c.flatUrl=function(a){return a.indexOf("?")===-1&&a.indexOf("#")===-1};c.amendUrl=function(a){var b=k.location;if(!a)throw Error("Wrong url for SockJS");if(!c.flatUrl(a))throw Error("Only basic urls are supported in SockJS");a.indexOf("//")===0&&(a=b.protocol+a);a.indexOf("/")===0&&(a=b.protocol+"//"+b.host+a);return a=a.replace(/[/]+$/,"")};c.arrIndexOf=function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1};c.arrSkip=function(a,b){var h=c.arrIndexOf(a,b);return h===
-1?a.slice():a.slice(0,h).concat(a.slice(h+1))};c.isArray=Array.isArray||function(a){return{}.toString.call(a).indexOf("Array")>=0};c.delay=function(a,b){typeof a==="function"&&(b=a,a=0);return setTimeout(b,a)};var v=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,C={"\x00":"\\u0000","\u0001":"\\u0001","\u0002":"\\u0002","\u0003":"\\u0003","\u0004":"\\u0004","\u0005":"\\u0005","\u0006":"\\u0006","\u0007":"\\u0007","\u0008":"\\b",
"\t":"\\t","\n":"\\n","\u000b":"\\u000b","\u000c":"\\f","\r":"\\r","\u000e":"\\u000e","\u000f":"\\u000f","\u0010":"\\u0010","\u0011":"\\u0011","\u0012":"\\u0012","\u0013":"\\u0013","\u0014":"\\u0014","\u0015":"\\u0015","\u0016":"\\u0016","\u0017":"\\u0017","\u0018":"\\u0018","\u0019":"\\u0019","\u001a":"\\u001a","\u001b":"\\u001b","\u001c":"\\u001c","\u001d":"\\u001d","\u001e":"\\u001e","\u001f":"\\u001f",'"':'\\"',"\\":"\\\\","\u007f":"\\u007f","\u0080":"\\u0080","\u0081":"\\u0081","\u0082":"\\u0082",
"\u0083":"\\u0083","\u0084":"\\u0084","\u0085":"\\u0085","\u0086":"\\u0086","\u0087":"\\u0087","\u0088":"\\u0088","\u0089":"\\u0089","\u008a":"\\u008a","\u008b":"\\u008b","\u008c":"\\u008c","\u008d":"\\u008d","\u008e":"\\u008e","\u008f":"\\u008f","\u0090":"\\u0090","\u0091":"\\u0091","\u0092":"\\u0092","\u0093":"\\u0093","\u0094":"\\u0094","\u0095":"\\u0095","\u0096":"\\u0096","\u0097":"\\u0097","\u0098":"\\u0098","\u0099":"\\u0099","\u009a":"\\u009a","\u009b":"\\u009b","\u009c":"\\u009c","\u009d":"\\u009d",
"\u009e":"\\u009e","\u009f":"\\u009f","\u00ad":"\\u00ad","\u0600":"\\u0600","\u0601":"\\u0601","\u0602":"\\u0602","\u0603":"\\u0603","\u0604":"\\u0604","\u070f":"\\u070f","\u17b4":"\\u17b4","\u17b5":"\\u17b5","\u200c":"\\u200c","\u200d":"\\u200d","\u200e":"\\u200e","\u200f":"\\u200f","\u2028":"\\u2028","\u2029":"\\u2029","\u202a":"\\u202a","\u202b":"\\u202b","\u202c":"\\u202c","\u202d":"\\u202d","\u202e":"\\u202e","\u202f":"\\u202f","\u2060":"\\u2060","\u2061":"\\u2061","\u2062":"\\u2062","\u2063":"\\u2063",
"\u2064":"\\u2064","\u2065":"\\u2065","\u2066":"\\u2066","\u2067":"\\u2067","\u2068":"\\u2068","\u2069":"\\u2069","\u206a":"\\u206a","\u206b":"\\u206b","\u206c":"\\u206c","\u206d":"\\u206d","\u206e":"\\u206e","\u206f":"\\u206f","\ufeff":"\\ufeff","\ufff0":"\\ufff0","\ufff1":"\\ufff1","\ufff2":"\\ufff2","\ufff3":"\\ufff3","\ufff4":"\\ufff4","\ufff5":"\\ufff5","\ufff6":"\\ufff6","\ufff7":"\\ufff7","\ufff8":"\\ufff8","\ufff9":"\\ufff9","\ufffa":"\\ufffa","\ufffb":"\\ufffb","\ufffc":"\\ufffc","\ufffd":"\\ufffd",
"\ufffe":"\\ufffe","\uffff":"\\uffff"},q=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,
A,L=JSON&&JSON.stringify||function(a){v.lastIndex=0;v.test(a)&&(a=a.replace(v,function(a){return C[a]}));return'"'+a+'"'},r=function(a){var b,c={},e=[];for(b=0;b<65536;b++)e.push(String.fromCharCode(b));a.lastIndex=0;e.join("").replace(a,function(a){c[a]="\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);return""});a.lastIndex=0;return c};c.quote=function(a){a=L(a);q.lastIndex=0;if(!q.test(a))return a;A||(A=r(q));return a.replace(q,function(a){return A[a]})};var o="websocket,xdr-streaming,xhr-streaming,iframe-eventsource,iframe-htmlfile,xdr-polling,xhr-polling,iframe-xhr-polling,jsonp-polling".split(",");
c.probeProtocols=function(){for(var a={},b=0;b<o.length;b++){var c=o[b];a[c]=d[c]&&d[c].enabled()}return a};c.detectProtocols=function(a,b,c){var e={},l=[];b||(b=o);for(var d=0;d<b.length;d++){var g=b[d];e[g]=a[g]}var f=function(a){var b=a.shift();e[b]?l.push(b):a.length>0&&f(a)};c.websocket!==!1&&f(["websocket"]);e["xhr-streaming"]&&!c.null_origin?l.push("xhr-streaming"):e["xdr-streaming"]&&!c.cookie_needed&&!c.null_origin?l.push("xdr-streaming"):f(["iframe-eventsource","iframe-htmlfile"]);e["xhr-polling"]&&
!c.null_origin?l.push("xhr-polling"):e["xdr-polling"]&&!c.cookie_needed&&!c.null_origin?l.push("xdr-polling"):f(["iframe-xhr-polling","jsonp-polling"]);return l};c.createHook=function(){var a="a"+c.random_string(8);if(!("_sockjs_global"in g)){var b={};g._sockjs_global=function(a){a in b||(b[a]={id:a,del:function(){delete b[a]}});return b[a]}}return g._sockjs_global(a)};c.attachMessage=function(a){c.attachEvent("message",a)};c.attachEvent=function(a,b){typeof g.addEventListener!=="undefined"?g.addEventListener(a,
b,!1):(k.attachEvent("on"+a,b),g.attachEvent("on"+a,b))};c.detachMessage=function(a){c.detachEvent("message",a)};c.detachEvent=function(a,b){typeof g.addEventListener!=="undefined"?g.removeEventListener(a,b,!1):(k.detachEvent("on"+a,b),g.detachEvent("on"+a,b))};var m={},B=!1,w=function(){for(var a in m)m[a](),delete m[a]};c.attachEvent("unload",function(){B||(B=!0,w())});c.unload_add=function(a){var b=c.random_string(8);m[b]=a;B&&c.delay(w);return b};c.unload_del=function(a){a in m&&delete m[a]};
c.createIframe=function(a,b){var h=k.createElement("iframe"),e,l,d=function(){clearTimeout(e);try{h.onload=null}catch(a){}h.onerror=null},g=function(){h&&(d(),setTimeout(function(){h&&h.parentNode.removeChild(h);h=null},0),c.unload_del(l))},f=function(a){h&&(g(),b(a))};h.src=a;h.style.display="none";h.style.position="absolute";h.onerror=function(){f("onerror")};h.onload=function(){clearTimeout(e);e=setTimeout(function(){f("onload timeout")},2E3)};k.body.appendChild(h);e=setTimeout(function(){f("timeout")},
15E3);l=c.unload_add(g);return{post:function(a,b){try{h&&h.contentWindow&&h.contentWindow.postMessage(a,b)}catch(c){}},cleanup:g,loaded:d}};c.createHtmlfile=function(a,b){var h=new ActiveXObject("htmlfile"),e,l,d,f=function(){clearTimeout(e)},i=function(){h&&(f(),c.unload_del(l),d.parentNode.removeChild(d),d=h=null,CollectGarbage())};h.open();h.write('<html><script>document.domain="'+document.domain+'";<\/script></html>');h.close();h.parentWindow._jp=g._jp;var j=h.createElement("div");h.body.appendChild(j);
d=h.createElement("iframe");j.appendChild(d);d.src=a;e=setTimeout(function(){h&&(i(),b("timeout"))},15E3);l=c.unload_add(i);return{post:function(a,b){try{d&&d.contentWindow&&d.contentWindow.postMessage(a,b)}catch(c){}},cleanup:i,loaded:f}};var f=function(){};f.prototype=new i(["chunk","finish"]);f.prototype._start=function(a,b,h,e){var d=this;try{d.xhr=new XMLHttpRequest}catch(f){}if(!d.xhr)try{d.xhr=new g.ActiveXObject("Microsoft.XMLHTTP")}catch(i){}if(g.ActiveXObject||g.XDomainRequest)b+=(b.indexOf("?")===
-1?"?":"&")+"t="+ +new Date;d.unload_ref=c.unload_add(function(){d._cleanup(!0)});try{d.xhr.open(a,b,!0)}catch(j){d.emit("finish",0,"");d._cleanup();return}if(!e||!e.no_credentials)d.xhr.withCredentials="true";if(e&&e.headers)for(var k in e.headers)d.xhr.setRequestHeader(k,e.headers[k]);d.xhr.onreadystatechange=function(){if(d.xhr){var a=d.xhr;switch(a.readyState){case 3:try{var b=a.status,c=a.responseText}catch(e){}c&&c.length>0&&d.emit("chunk",b,c);break;case 4:d.emit("finish",a.status,a.responseText),
d._cleanup(!1)}}};d.xhr.send(h)};f.prototype._cleanup=function(a){if(this.xhr){c.unload_del(this.unload_ref);this.xhr.onreadystatechange=function(){};if(a)try{this.xhr.abort()}catch(b){}this.unload_ref=this.xhr=null}};f.prototype.close=function(){this.nuke();this._cleanup(!0)};(c.XHRCorsObject=function(){var a=this,b=arguments;c.delay(function(){a._start.apply(a,b)})}).prototype=new f;(c.XHRLocalObject=function(a,b,d){var e=this;c.delay(function(){e._start(a,b,d,{no_credentials:!0})})}).prototype=
new f;f=c.XDRObject=function(a,b,d){var e=this;c.delay(function(){e._start(a,b,d)})};f.prototype=new i(["chunk","finish"]);f.prototype._start=function(a,b,d){var e=this,l=new XDomainRequest;b+=(b.indexOf("?")===-1?"?":"&")+"t="+ +new Date;var f=l.ontimeout=l.onerror=function(){e.emit("finish",0,"");e._cleanup(!1)};l.onprogress=function(){e.emit("chunk",200,l.responseText)};l.onload=function(){e.emit("finish",200,l.responseText);e._cleanup(!1)};e.xdr=l;e.unload_ref=c.unload_add(function(){e._cleanup(!0)});
try{e.xdr.open(a,b),e.xdr.send(d)}catch(g){f()}};f.prototype._cleanup=function(a){if(this.xdr){c.unload_del(this.unload_ref);this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null;if(a)try{this.xdr.abort()}catch(b){}this.unload_ref=this.xdr=null}};f.prototype.close=function(){this.nuke();this._cleanup(!0)};c.isXHRCorsCapable=function(){return g.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest?1:g.XDomainRequest&&k.domain?2:p.enabled()?3:4};var d=function(a,b,h){var e=this,
l;e._options={devel:!1,debug:!1,protocols_whitelist:[],info:void 0,rtt:void 0};h&&c.objectExtend(e._options,h);e._base_url=c.amendUrl(a);e._server=e._options.server||c.random_number_string(1E3);e._options.protocols_whitelist&&e._options.protocols_whitelist.length?l=e._options.protocols_whitelist:(l=typeof b==="string"&&b.length>0?[b]:c.isArray(b)?b:null)&&e._debug('Deprecated API: Use "protocols_whitelist" option instead of supplying protocol list as a second parameter to SockJS constructor.');e._protocols=
[];e.protocol=null;e.readyState=d.CONNECTING;e._ir=M(e._base_url);e._ir.onfinish=function(a,b){e._ir=null;if(a){e._options.info&&(a=c.objectExtend(a,e._options.info));if(e._options.rtt)b=e._options.rtt;e._applyInfo(a,b,l);e._didClose()}else e._didClose(1002,"Can't connect to server",!0)}};d.prototype=new n;d.version="0.3.1";d.CONNECTING=0;d.OPEN=1;d.CLOSING=2;d.CLOSED=3;d.prototype._debug=function(){this._options.debug&&c.log.apply(c,arguments)};d.prototype._dispatchOpen=function(){if(this.readyState===
d.CONNECTING){if(this._transport_tref)clearTimeout(this._transport_tref),this._transport_tref=null;this.readyState=d.OPEN;this.dispatchEvent(new j("open"))}else this._didClose(1006,"Server lost session")};d.prototype._dispatchMessage=function(a){if(this.readyState===d.OPEN)switch(a=JSON.parse(a),a.op){case "ortc-validated":this.dispatchEvent(new j("ortcvalidated",{data:a.up,set:a.set}));break;case "ortc-subscribed":this.dispatchEvent(new j("ortcsubscribed",{data:a.ch}));break;case "ortc-unsubscribed":this.dispatchEvent(new j("ortcunsubscribed",
{data:a.ch}));break;case "ortc-error":this.dispatchEvent(new j("ortcerror",{data:a.ex}));break;default:this.dispatchEvent(new j("message",{data:a}))}};d.prototype._dispatchHeartbeat=function(){this.readyState===d.OPEN&&this.dispatchEvent(new j("heartbeat",{}))};d.prototype._didClose=function(a,b,h){var e=this;if(e.readyState!==d.CONNECTING&&e.readyState!==d.OPEN&&e.readyState!==d.CLOSING)throw Error("INVALID_STATE_ERR");if(e._ir)e._ir.nuke(),e._ir=null;if(e._transport)e._transport.doCleanup(),e._transport=
null;var l=new j("close",{code:a,reason:b,wasClean:c.userSetCode(a)});if(!c.userSetCode(a)&&e.readyState===d.CONNECTING&&!h){if(e._try_next_protocol(l))return;l=new j("close",{code:2E3,reason:"All transports failed",wasClean:!1,last_event:l})}e.readyState=d.CLOSED;c.delay(function(){e.dispatchEvent(l)})};d.prototype._didMessage=function(a){switch(a.slice(0,1)){case "o":this._dispatchOpen();break;case "a":for(var a=JSON.parse(a.slice(1)||"[]"),b=0;b<a.length;b++)this._dispatchMessage(a[b]);break;case "m":a=
JSON.parse(a.slice(1)||"null");this._dispatchMessage(a);break;case "c":a=JSON.parse(a.slice(1)||"[]");this._didClose(a[0],a[1]);break;case "h":this._dispatchHeartbeat()}};d.prototype._try_next_protocol=function(a){var b=this;if(b.protocol)b._debug("Closed transport:",b.protocol,""+a),b.protocol=null;if(b._transport_tref)clearTimeout(b._transport_tref),b._transport_tref=null;for(;;){a=b.protocol=b._protocols.shift();if(!a)return!1;if(d[a]&&d[a].need_body===!0&&(!k.body||typeof k.readyState!=="undefined"&&
k.readyState!=="complete"))return b._protocols.unshift(a),b.protocol="waiting-for-load",c.attachEvent("load",function(){b._try_next_protocol()}),!0;if(!d[a]||!d[a].enabled(b._options))b._debug("Skipping transport:",a);else{b._transport_tref=c.delay((b._options.rto||0)*(d[a].roundTrips||1)||5E3,function(){b.readyState===d.CONNECTING&&b._didClose(2007,"Transport timeouted")});var h=c.random_string(8),h=b._base_url+"/"+b._server+"/"+h;b._debug("Opening transport:",a," url:"+h," RTO:"+b._options.rto);
b._transport=new d[a](b,h,b._base_url);return!0}}};d.prototype.close=function(a,b){if(a&&!c.userSetCode(a))throw Error("INVALID_ACCESS_ERR");if(this.readyState!==d.CONNECTING&&this.readyState!==d.OPEN)return!1;this.readyState=d.CLOSING;this._didClose(a||1E3,b||"Normal closure");return!0};d.prototype.send=function(a){if(this.readyState===d.CONNECTING)throw Error("INVALID_STATE_ERR");this.readyState===d.OPEN&&this._transport.doSend(c.quote(""+a));return!0};d.prototype._applyInfo=function(a,b,d){this._options.info=
a;this._options.rtt=b;this._options.rto=c.countRTO(b);this._options.info.null_origin=!k.domain;b=c.probeProtocols();this._protocols=c.detectProtocols(b,d,a)};f=d.websocket=function(a,b){var d=this,e=b+"/websocket",e=e.slice(0,5)==="https"?"wss"+e.slice(5):"ws"+e.slice(4);d.ri=a;d.url=e;d.ws=new (g.WebSocket||g.MozWebSocket)(d.url);d.ws.onmessage=function(a){d.ri._didMessage(a.data)};d.unload_ref=c.unload_add(function(){d.ws.close()});d.ws.onclose=function(){d.ri._didMessage(c.closeFrame(1006,"WebSocket connection broken"))}};
f.prototype.doSend=function(a){this.ws.send("["+a+"]")};f.prototype.doCleanup=function(){var a=this.ws;if(a)a.onmessage=a.onclose=null,a.close(),c.unload_del(this.unload_ref),this.unload_ref=this.ri=this.ws=null};f.enabled=function(){return!(!g.WebSocket&&!g.MozWebSocket)};f.roundTrips=2;var s=function(){};s.prototype.send_constructor=function(a){this.send_buffer=[];this.sender=a};s.prototype.doSend=function(a){this.send_buffer.push(a);this.send_stop||this.send_schedule()};s.prototype.send_schedule_wait=
function(){var a=this,b;a.send_stop=function(){a.send_stop=null;clearTimeout(b)};b=c.delay(25,function(){a.send_stop=null;a.send_schedule()})};s.prototype.send_schedule=function(){var a=this;if(a.send_buffer.length>0){var b="["+a.send_buffer.join(",")+"]";a.send_stop=a.sender(a.trans_url,b,function(){a.send_stop=null;a.send_schedule_wait()});a.send_buffer=[]}};s.prototype.send_destructor=function(){this._send_stop&&this._send_stop();this._send_stop=null};var N=function(a,b,d){if(!("_send_form"in this)){var e=
this._send_form=k.createElement("form"),l=this._send_area=k.createElement("textarea");l.name="d";e.style.display="none";e.style.position="absolute";e.method="POST";e.enctype="application/x-www-form-urlencoded";e.acceptCharset="UTF-8";e.appendChild(l);k.body.appendChild(e)}var e=this._send_form,l=this._send_area,f="a"+c.random_string(8);e.target=f;e.action=a+"/jsonp_send?i="+f;var g;try{g=k.createElement('<iframe name="'+f+'">')}catch(i){g=k.createElement("iframe"),g.name=f}g.id=f;e.appendChild(g);
g.style.display="none";try{l.value=b}catch(j){c.log("Your browser is seriously broken. Go home! "+j.message)}e.submit();var m=function(){if(g.onerror)g.onreadystatechange=g.onerror=g.onload=null,c.delay(500,function(){g.parentNode.removeChild(g);g=null}),l.value="",d()};g.onerror=g.onload=m;g.onreadystatechange=function(){g.readyState=="complete"&&m()};return m},O=function(a){return function(b,c,e){(new a("POST",b+"/xhr_send",c)).onfinish=function(a){e(a)};return function(a){e(0,a)}}},P=function(a,
b){var d,e=k.createElement("script"),g,f=function(a){var h;g&&(g.parentNode.removeChild(g),g=null);if(e)clearTimeout(d),e.parentNode.removeChild(e),h=e.onreadystatechange=e.onerror=e.onload=e.onclick=null,e=h,b(a),b=null},i=!1,j=null;e.id="a"+c.random_string(8);e.src=a;e.type="text/javascript";e.charset="UTF-8";e.onerror=function(){j||(j=setTimeout(function(){i||f(c.closeFrame(1006,"JSONP script loaded abnormally (onerror)"))},1E3))};e.onload=function(){f(c.closeFrame(1006,"JSONP script loaded abnormally (onload)"))};
e.onreadystatechange=function(){if(/loaded|closed/.test(e.readyState)){if(e&&e.htmlFor&&e.onclick){i=!0;try{e.onclick()}catch(a){}}e&&f(c.closeFrame(1006,"JSONP script loaded abnormally (onreadystatechange)"))}};if(typeof e.async==="undefined"&&k.attachEvent)if(/opera/i.test(navigator.userAgent))g=k.createElement("script"),g.text="try{var a = document.getElementById('"+e.id+"'); if(a)a.onerror();}catch(x){};",e.async=g.async=!1;else{try{e.htmlFor=e.id,e.event="onclick"}catch(m){}e.async=!0}if(typeof e.async!==
"undefined")e.async=!0;d=setTimeout(function(){f(c.closeFrame(1006,"JSONP script loaded abnormally (timeout)"))},35E3);var n=k.getElementsByTagName("head")[0];n.insertBefore(e,n.firstChild);g&&n.insertBefore(g,n.firstChild);return f},f=d["jsonp-polling"]=function(a,b){c.polluteGlobalNamespace();this.ri=a;this.trans_url=b;this.send_constructor(N);this._schedule_recv()};f.prototype=new s;f.prototype._schedule_recv=function(){var a=this;a._recv_stop=Q(a.trans_url+"/jsonp",P,function(b){a._recv_stop=
null;b&&(a._is_closing||a.ri._didMessage(b));a._is_closing||a._schedule_recv()})};f.enabled=function(){return!0};f.need_body=!0;f.prototype.doCleanup=function(){this._is_closing=!0;this._recv_stop&&this._recv_stop();this.ri=this._recv_stop=null;this.send_destructor()};var Q=function(a,b,d){var e="a"+c.random_string(6),a=a+"?c="+escape("_jp."+e),b=b(a,function(a){delete g._jp[e];d(a)});g._jp[e]=b;return function(){if(g._jp[e])g._jp[e](c.closeFrame(1E3,"JSONP user aborted read"))}},f=function(){};f.prototype=
new s;f.prototype.run=function(a,b,c,e,d){this.ri=a;this.trans_url=b;this.send_constructor(O(d));this.poll=new D(a,e,b+c,d)};f.prototype.doCleanup=function(){if(this.poll)this.poll.abort(),this.poll=null};var u=d["xhr-streaming"]=function(a,b){this.run(a,b,"/xhr_streaming",x,c.XHRCorsObject)};u.prototype=new f;u.enabled=function(){return g.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest&&!/opera/i.test(navigator.userAgent)};u.roundTrips=2;u.need_body=!0;s=d["xdr-streaming"]=function(a,b){this.run(a,
b,"/xhr_streaming",x,c.XDRObject)};s.prototype=new f;s.enabled=function(){return!!g.XDomainRequest};s.roundTrips=2;var E=d["xhr-polling"]=function(a,b){this.run(a,b,"/xhr",x,c.XHRCorsObject)};E.prototype=new f;E.enabled=u.enabled;E.roundTrips=2;u=d["xdr-polling"]=function(a,b){this.run(a,b,"/xhr",x,c.XDRObject)};u.prototype=new f;u.enabled=s.enabled;u.roundTrips=2;var p=function(){};p.prototype.i_constructor=function(a,b,d){var e=this;e.ri=a;e.origin=c.getOrigin(d);e.base_url=d;e.trans_url=b;a=d+
"/iframe.html";e.ri._options.devel&&(a+="?t="+ +new Date);e.window_id=c.random_string(8);a+="#"+e.window_id;e.iframeObj=c.createIframe(a,function(a){e.ri._didClose(1006,"Unable to load an iframe ("+a+")")});e.onmessage_cb=c.bind(e.onmessage,e);c.attachMessage(e.onmessage_cb)};p.prototype.doCleanup=function(){if(this.iframeObj){c.detachMessage(this.onmessage_cb);try{this.iframeObj.iframe.contentWindow&&this.postMessage("c")}catch(a){}this.iframeObj.cleanup();this.onmessage_cb=this.iframeObj=this.iframeObj=
null}};p.prototype.onmessage=function(a){if(a.origin===this.origin){var b=a.data.slice(0,8),c=a.data.slice(8,9),a=a.data.slice(9);if(b===this.window_id)switch(c){case "s":this.iframeObj.loaded();this.postMessage("s",JSON.stringify([d.version,this.protocol,this.trans_url,this.base_url]));break;case "t":this.ri._didMessage(a)}}};p.prototype.postMessage=function(a,b){this.iframeObj.post(this.window_id+a+(b||""),this.origin)};p.prototype.doSend=function(a){this.postMessage("m",a)};p.enabled=function(){var a=
navigator&&navigator.userAgent&&navigator.userAgent.indexOf("Konqueror")!==-1;return(typeof g.postMessage==="function"||typeof g.postMessage==="object")&&!a};var F,G=function(a,b){parent!==g?parent.postMessage(F+a+(b||""),"*"):c.log("Can't postMessage, no parent window.",a,b)},t=function(){};t.prototype._didClose=function(a,b){G("t",c.closeFrame(a,b))};t.prototype._didMessage=function(a){G("t",a)};t.prototype._doSend=function(a){this._transport.doSend(a)};t.prototype._doCleanup=function(){this._transport.doCleanup()};
c.parent_origin=void 0;d.bootstrap_iframe=function(){var a;F=k.location.hash.slice(1);c.attachMessage(function(b){if(b.source===parent){if(typeof c.parent_origin==="undefined")c.parent_origin=b.origin;if(b.origin===c.parent_origin){var h=b.data.slice(0,8),e=b.data.slice(8,9),b=b.data.slice(9);if(h===F)switch(e){case "s":var f=JSON.parse(b),h=f[0],e=f[1],b=f[2],f=f[3];h!==d.version&&c.log('Incompatibile SockJS! Main site uses: "'+h+'", the iframe: "'+d.version+'".');if(!c.flatUrl(b)||!c.flatUrl(f)){c.log("Only basic urls are supported in SockJS");
break}if(!c.isSameOriginUrl(b)||!c.isSameOriginUrl(f)){c.log("Can't connect to different domain from within an iframe. ("+JSON.stringify([g.location.href,b,f])+")");break}a=new t;a._transport=new t[e](a,b,f);break;case "m":a._doSend(b);break;case "c":a&&a._doCleanup(),a=null}}}});G("s")};var y=function(a,b){var d=this;c.delay(function(){d.doXhr(a,b)})};y.prototype=new i(["finish"]);y.prototype.doXhr=function(){var a;navigator&&navigator.userAgent?(a=navigator.userAgent.toLowerCase(),a=a.indexOf("msie")!=
-1?parseInt(a.split("msie")[1]):!1):a=!1;this.emit("finish",{websocket:!a||a>9,origins:["*:*"],cookie_needed:!1,entropy:+new Date},5E3)};var J=function(a){var b=this,d=function(){var c=new p;c.protocol="w-iframe-info-receiver";var d=function(a){typeof a==="string"&&a.substr(0,1)==="m"?(a=JSON.parse(a.substr(1)),b.emit("finish",a[0],a[1])):b.emit("finish");c.doCleanup();c=null};c.i_constructor({_options:{},_didClose:d,_didMessage:d},a,a)};k.body?d():c.attachEvent("load",d)};J.prototype=new i(["finish"]);
var K=function(){var a=this;c.delay(function(){a.emit("finish",{},5E3)})};K.prototype=new i(["finish"]);var M=function(a){if(c.isSameOriginUrl(a))return new y(a,c.XHRLocalObject);switch(c.isXHRCorsCapable()){case 1:return new y(a,c.XHRCorsObject);case 2:return new y(a,c.XDRObject);case 3:return new J(a);default:return new K}};(t["w-iframe-info-receiver"]=function(a,b,d){(new y(d,c.XHRLocalObject)).onfinish=function(b,c){a._didMessage("m"+JSON.stringify([b,c]));a._didClose()}}).prototype.doCleanup=
function(){};i=d["iframe-eventsource"]=function(){this.protocol="w-iframe-eventsource";this.i_constructor.apply(this,arguments)};i.prototype=new p;i.enabled=function(){return"EventSource"in g&&p.enabled()};i.need_body=!0;i.roundTrips=3;(t["w-iframe-eventsource"]=function(a,b){this.run(a,b,"/eventsource",H,c.XHRLocalObject)}).prototype=new f;i=d["iframe-xhr-polling"]=function(){this.protocol="w-iframe-xhr-polling";this.i_constructor.apply(this,arguments)};i.prototype=new p;i.enabled=function(){return g.XMLHttpRequest&&
p.enabled()};i.need_body=!0;i.roundTrips=3;(t["w-iframe-xhr-polling"]=function(a,b){this.run(a,b,"/xhr",x,c.XHRLocalObject)}).prototype=new f;i=d["iframe-htmlfile"]=function(){this.protocol="w-iframe-htmlfile";this.i_constructor.apply(this,arguments)};i.prototype=new p;i.enabled=function(){return p.enabled()};i.need_body=!0;i.roundTrips=3;(t["w-iframe-htmlfile"]=function(a,b){this.run(a,b,"/htmlfile",I,c.XHRLocalObject)}).prototype=new f;var D=function(a,b,c,e){this.ri=a;this.Receiver=b;this.recv_url=
c;this.AjaxObject=e;this._scheduleRecv()};D.prototype._scheduleRecv=function(){var a=this,b=a.poll=new a.Receiver(a.recv_url,a.AjaxObject),c=0;b.onmessage=function(b){c+=1;a.ri._didMessage(b.data)};b.onclose=function(c){var e;a.poll=(e=b.onmessage=b.onclose=null,b=e);a.poll_is_closing||(c.reason==="permanent"?a.ri._didClose(1006,"Polling error ("+c.reason+")"):a._scheduleRecv())}};D.prototype.abort=function(){this.poll_is_closing=!0;this.poll&&this.poll.abort()};var H=function(a){var b=this,d=new EventSource(a);
d.onmessage=function(a){b.dispatchEvent(new j("message",{data:unescape(a.data)}))};b.es_close=d.onerror=function(a,g){var f=g?"user":d.readyState!==2?"network":"permanent";b.es_close=d.onmessage=d.onerror=null;d.close();d=null;c.delay(200,function(){b.dispatchEvent(new j("close",{reason:f}))})}};H.prototype=new n;H.prototype.abort=function(){this.es_close&&this.es_close({},!0)};var z,I=function(a){var b=this;c.polluteGlobalNamespace();b.id="a"+c.random_string(6,26);a+=(a.indexOf("?")===-1?"?":"&")+
"c="+escape("_jp."+b.id);if(z===void 0)if("ActiveXObject"in g)try{z=!!new ActiveXObject("htmlfile")}catch(d){}else z=!1;var e=z?c.createHtmlfile:c.createIframe,f;g._jp[b.id]={start:function(){f.loaded()},message:function(a){b.dispatchEvent(new j("message",{data:a}))},stop:function(){b.iframe_close({},"network")}};b.iframe_close=function(a,c){f.cleanup();b.iframe_close=f=null;delete g._jp[b.id];b.dispatchEvent(new j("close",{reason:c}))};f=e(a,function(){b.iframe_close({},"permanent")})};I.prototype=
new n;I.prototype.abort=function(){this.iframe_close&&this.iframe_close({},"user")};var x=function(a,b){var c=this,e=0;c.xo=new b("POST",a,null);c.xo.onchunk=function(a,b){if(a===200)for(;;){var d=b.slice(e),f=d.indexOf("\n");if(f===-1)break;e+=f+1;d=d.slice(0,f);c.dispatchEvent(new j("message",{data:d}))}};c.xo.onfinish=function(a,b){c.xo.onchunk(a,b);c.xo=null;c.dispatchEvent(new j("close",{reason:a===200?"network":"permanent"}))}};x.prototype=new n;x.prototype.abort=function(){if(this.xo)this.xo.close(),
this.dispatchEvent(new j("close",{reason:"user"})),this.xo=null};d.getUtils=function(){return c};d.getIframeTransport=function(){return p};return d}();"_sockjs_onload"in window&&setTimeout(_sockjs_onload,1);typeof define==="function"&&define.amd&&define("sockjs",[],function(){return SockJS});
